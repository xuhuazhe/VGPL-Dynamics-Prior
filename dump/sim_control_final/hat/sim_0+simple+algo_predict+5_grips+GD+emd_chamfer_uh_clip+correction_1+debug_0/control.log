ENV:
  loss:
    soft_contact: False
    target_path: envs/assets/Chopsticks3D-v1.npy
    weight:
      contact: 1
      density: 10
      sdf: 10
  n_observed_particles: 200
PRIMITIVES: [{'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.35, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.65, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.13, 'r': 0.025, 'init_pos': '(0.5, 0.1, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.2, 0.2, 0.2)', 'friction': 15.0}]
RENDERER:
  bake_size: 6
  camera_pos: (0.5, 1.2, 4.0)
  camera_pos_1: (0.5, 2.5, 2.2)
  camera_pos_2: (0.5, 2.5, 2.2)
  camera_pos_3: (0.5, 2.5, 2.2)
  camera_pos_4: (0.5, 2.5, 2.2)
  camera_rot: (0.2, 0)
  camera_rot_1: (0.8, 0.0)
  camera_rot_2: (0.8, 0.0)
  camera_rot_3: (0.8, 0.0)
  camera_rot_4: (0.8, 0.0)
  dx: 0.006666666666666667
  image_res: (512, 512)
  light_direction: (2.0, 1.0, 0.7)
  max_num_particles: 1000000
  max_ray_depth: 2
  sdf_threshold: 0.20720000000000002
  spp: 50
  target_res: (64, 64, 64)
  use_directional_light: False
  use_roulette: False
  voxel_res: (168, 168, 168)
SHAPES: [{'shape': 'box', 'width': '(0.25, 0.2, 0.25)', 'init_pos': '(0.5, 0.1, 0.5)', 'n_particles': 20000, 'color': '((150<<8)+ (150<<16))'}]
SIMULATOR:
  E: 5000.0
  dim: 3
  dtype: float64
  gravity: (0, -5, 0)
  ground_friction: 100.0
  max_steps: 1024
  n_particles: 9000
  nu: 0.2
  quality: 1
  yield_stress: 4000.0
VARIANTS: [{'ENV': {'loss': {'target_path': 'envs/assets/gripper-v1.npy'}}}]
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.35, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.65, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 0
  scale: ()
color: (0.2, 0.2, 0.2)
friction: 15.0
h: 0.13
init_pos: (0.5, 0.1, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.025
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
{'width': (0.25, 0.2, 0.25), 'init_pos': (0.5, 0.1, 0.5), 'n_particles': 20000, 'color': 9868800}
Initialize Renderer
bake_size: 6  
camera_pos: (0.5, 1.2, 4.0)  
camera_pos_1: (0.5, 2.5, 2.2)  
camera_pos_2: (0.5, 2.5, 2.2)  
camera_pos_3: (0.5, 2.5, 2.2)  
camera_pos_4: (0.5, 2.5, 2.2)  
camera_rot: (0.2, 0)  
camera_rot_1: (0.8, 0.0)  
camera_rot_2: (0.8, 0.0)  
camera_rot_3: (0.8, 0.0)  
camera_rot_4: (0.8, 0.0)  
dx: 0.006666666666666667  
image_res: (512, 512)  
light_direction: (2.0, 1.0, 0.7)  
max_num_particles: 1000000  
max_ray_depth: 2  
sdf_threshold: 0.20720000000000002  
spp: 50  
target_res: (64, 64, 64)  
use_directional_light: False  
use_roulette: False  
voxel_res: (168, 168, 168)
[Taichi] materializing...
model_kp #params: 443560
GT shape: init pose: (1, 3, 11, 14); actions: (1, 3, 40, 12)
GT init pose: [[0.49119963 0.14       0.92617013 1.         0.         0.
  0.        ]
 [0.90975371 0.14       0.62744569 1.         0.         0.
  0.        ]
 [0.66744627 0.14       0.8448659  1.         0.         0.
  0.        ]]
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 43670 / 28229
[Open3D DEBUG] #   Got kernel density: 0.181582 (s), 4316.65 (MB) / 4316.65 (MB) / 4338 (MB)
[Open3D DEBUG] #     Got normal field: 0.07739 (s), 4321.98 (MB) / 4321.98 (MB) / 4338 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 2.048149e-05 / 8.944265e-01
[Open3D DEBUG] #       Finalized tree: 1.03019 (s), 4323.0 (MB) / 4323.0 (MB) / 4338 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.9377 (s), 4323.0 (MB) / 4323.0 (MB) / 4338 (MB)
[Open3D DEBUG] #Set point constraints: 0.600359 (s), 4323.0 (MB) / 4323.0 (MB) / 4338 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 309163 / 351456 / 1873
[Open3D DEBUG] Memory Usage: 4322.996 MB
[Open3D DEBUG] # Linear system solved: 7.86548 (s), 4323.0 (MB) / 4323.0 (MB) / 4338 (MB)
[Open3D DEBUG] Got average: 0.196364 (s), 4323.0 (MB) / 4323.0 (MB) / 4338 (MB)
[Open3D DEBUG] Iso-Value: 5.039395e-01 = 2.200704e+04 / 4.367000e+04
[Open3D DEBUG] #          Total Solve:      51.7 (s),    4338.4 (MB)
TriangleMesh with 45345 points and 90678 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0294, mean: -0.0329, std: 0.0019
Selected top reward seqs: tensor([-0.0308, -0.0307, -0.0307, -0.0307, -0.0306, -0.0306, -0.0304, -0.0304,
        -0.0303, -0.0303, -0.0303, -0.0302, -0.0302, -0.0299, -0.0299, -0.0298,
        -0.0296, -0.0296, -0.0296, -0.0294])
Batch 0/20:
reward seqs after 9 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 8 iterations: tensor([-0.0319], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 14 iterations: tensor([-0.0311], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 22 iterations: tensor([-0.0306], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 6 iterations: tensor([-0.0314], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 13 iterations: tensor([-0.0298], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 14 iterations: tensor([-0.0303], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 4 iterations: tensor([-0.0305], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 11 iterations: tensor([-0.0317], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 6 iterations: tensor([-0.0307], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 19 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 12 iterations: tensor([-0.0314], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 13 iterations: tensor([-0.0303], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 13 iterations: tensor([-0.0300], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 10 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 12 iterations: tensor([-0.0292], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 11 iterations: tensor([-0.0298], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 14 iterations: tensor([-0.0298], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 15 iterations: tensor([-0.0292], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 7 iterations: tensor([-0.0301], grad_fn=<CatBackward>)
Loss: 0.02922232821583748
Optimal set of params:
mid_point: tensor([[0.4221, 0.1400, 0.4437],
        [0.5244, 0.1400, 0.4559]])
angle: tensor([1.7242, 2.2374], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0099], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.4832, 0.1400, 0.8390, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.7717, 0.1400, 0.7703, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 44461 / 39128
[Open3D DEBUG] #   Got kernel density: 0.320580 (s), 5645.89 (MB) / 5645.89 (MB) / 5677 (MB)
[Open3D DEBUG] #     Got normal field: 0.507807 (s), 5653.91 (MB) / 5653.91 (MB) / 5677 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.247221e-05 / 2.777577e+00
[Open3D DEBUG] #       Finalized tree: 1.3155 (s), 5654.96 (MB) / 5654.96 (MB) / 5677 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.10622 (s), 5654.96 (MB) / 5654.96 (MB) / 5677 (MB)
[Open3D DEBUG] #Set point constraints: 1.39485 (s), 5654.96 (MB) / 5654.96 (MB) / 5677 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 527087 / 476544 / 125841
[Open3D DEBUG] Memory Usage: 5654.961 MB
[Open3D DEBUG] # Linear system solved: 12.4723 (s), 5654.96 (MB) / 5654.96 (MB) / 5677 (MB)
[Open3D DEBUG] Got average: 0.336456 (s), 5655.4 (MB) / 5655.4 (MB) / 5677 (MB)
[Open3D DEBUG] Iso-Value: 5.015366e-01 = 2.229882e+04 / 4.446100e+04
[Open3D DEBUG] #          Total Solve:      69.4 (s),    5665.9 (MB)
TriangleMesh with 73488 points and 146866 triangles.
EMD: tensor([0.0287], dtype=torch.float64)
Chamfer: tensor([0.0390], dtype=torch.float64)
=============== Iteration 0 -> model_loss: tensor([0.0292]); sim_loss: tensor([0.0297], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 43457 / 37260
[Open3D DEBUG] #   Got kernel density: 0.211225 (s), 5659.56 (MB) / 5665.89 (MB) / 5691 (MB)
[Open3D DEBUG] #     Got normal field: 0.111953 (s), 5663.49 (MB) / 5665.89 (MB) / 5691 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.306060e-05 / 2.305854e+00
[Open3D DEBUG] #       Finalized tree: 1.17782 (s), 5663.72 (MB) / 5665.89 (MB) / 5691 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.11431 (s), 5663.72 (MB) / 5665.89 (MB) / 5691 (MB)
[Open3D DEBUG] #Set point constraints: 1.40810 (s), 5663.72 (MB) / 5665.89 (MB) / 5691 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 473901 / 437104 / 104497
[Open3D DEBUG] Memory Usage: 5663.719 MB
[Open3D DEBUG] # Linear system solved: 10.1239 (s), 5663.88 (MB) / 5665.89 (MB) / 5691 (MB)
[Open3D DEBUG] Got average: 0.370083 (s), 5663.88 (MB) / 5665.89 (MB) / 5691 (MB)
[Open3D DEBUG] Iso-Value: 5.038657e-01 = 2.189649e+04 / 4.345700e+04
[Open3D DEBUG] #          Total Solve:      63.3 (s),    5667.7 (MB)
TriangleMesh with 65190 points and 130310 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0271, mean: -0.0319, std: 0.0022
Selected top reward seqs: tensor([-0.0291, -0.0291, -0.0290, -0.0290, -0.0290, -0.0288, -0.0288, -0.0288,
        -0.0287, -0.0287, -0.0286, -0.0284, -0.0284, -0.0283, -0.0282, -0.0282,
        -0.0280, -0.0275, -0.0275, -0.0271])
Batch 0/20:
reward seqs after 9 iterations: tensor([-0.0289], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 10 iterations: tensor([-0.0297], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 5 iterations: tensor([-0.0293], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 12 iterations: tensor([-0.0293], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 11 iterations: tensor([-0.0281], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 10 iterations: tensor([-0.0282], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 22 iterations: tensor([-0.0290], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 26 iterations: tensor([-0.0288], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 13 iterations: tensor([-0.0280], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 16 iterations: tensor([-0.0284], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 21 iterations: tensor([-0.0290], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 12 iterations: tensor([-0.0279], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 17 iterations: tensor([-0.0287], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 3 iterations: tensor([-0.0297], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 10 iterations: tensor([-0.0284], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 12 iterations: tensor([-0.0273], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 9 iterations: tensor([-0.0277], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 16 iterations: tensor([-0.0267], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 15 iterations: tensor([-0.0276], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 20 iterations: tensor([-0.0262], grad_fn=<CatBackward>)
Loss: 0.026212334632873535
Optimal set of params:
mid_point: tensor([[0.5647, 0.1400, 0.4592],
        [0.5780, 0.1400, 0.4529]])
angle: tensor([1.7617, 0.4429], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0074], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.6406, 0.1400, 0.8519, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.2166, 0.1400, 0.6243, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 44482 / 34916
[Open3D DEBUG] #   Got kernel density: 0.246993 (s), 5724.19 (MB) / 5724.19 (MB) / 5757 (MB)
[Open3D DEBUG] #     Got normal field: 0.506742 (s), 5726.45 (MB) / 5726.45 (MB) / 5757 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 3.470689e-05 / 1.543832e+00
[Open3D DEBUG] #       Finalized tree: 1.18812 (s), 5726.71 (MB) / 5726.71 (MB) / 5757 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.09764 (s), 5726.71 (MB) / 5726.71 (MB) / 5757 (MB)
[Open3D DEBUG] #Set point constraints: 1.04448 (s), 5726.71 (MB) / 5726.71 (MB) / 5757 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 447644 / 484288 / 27305
[Open3D DEBUG] Memory Usage: 5726.711 MB
[Open3D DEBUG] # Linear system solved: 10.2090 (s), 5726.72 (MB) / 5726.72 (MB) / 5757 (MB)
[Open3D DEBUG] Got average: 0.346961 (s), 5726.72 (MB) / 5726.72 (MB) / 5757 (MB)
[Open3D DEBUG] Iso-Value: 5.039099e-01 = 2.241492e+04 / 4.448200e+04
[Open3D DEBUG] #          Total Solve:      60.2 (s),    5736.4 (MB)
TriangleMesh with 72636 points and 145272 triangles.
EMD: tensor([0.0272], dtype=torch.float64)
Chamfer: tensor([0.0376], dtype=torch.float64)
=============== Iteration 1 -> model_loss: tensor([0.0262]); sim_loss: tensor([0.0282], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 44745 / 38881
[Open3D DEBUG] #   Got kernel density: 0.36728 (s), 5731.2 (MB) / 5736.36 (MB) / 5804 (MB)
[Open3D DEBUG] #     Got normal field: 0.252692 (s), 5735.17 (MB) / 5736.36 (MB) / 5804 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.791304e-05 / 2.591319e+00
[Open3D DEBUG] #       Finalized tree: 1.28359 (s), 5735.49 (MB) / 5736.36 (MB) / 5804 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.94097 (s), 5735.49 (MB) / 5736.36 (MB) / 5804 (MB)
[Open3D DEBUG] #Set point constraints: 1.00228 (s), 5735.49 (MB) / 5736.36 (MB) / 5804 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 518421 / 478552 / 113929
[Open3D DEBUG] Memory Usage: 5735.492 MB
[Open3D DEBUG] # Linear system solved: 11.747 (s), 5735.88 (MB) / 5736.36 (MB) / 5804 (MB)
[Open3D DEBUG] Got average: 0.283707 (s), 5735.88 (MB) / 5736.36 (MB) / 5804 (MB)
[Open3D DEBUG] Iso-Value: 5.017740e-01 = 2.245187e+04 / 4.474500e+04
[Open3D DEBUG] #          Total Solve:      66.0 (s),    5741.6 (MB)
TriangleMesh with 74123 points and 148176 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0255, mean: -0.0313, std: 0.0023
Selected top reward seqs: tensor([-0.0283, -0.0283, -0.0283, -0.0281, -0.0280, -0.0280, -0.0278, -0.0276,
        -0.0276, -0.0275, -0.0272, -0.0272, -0.0270, -0.0266, -0.0266, -0.0265,
        -0.0262, -0.0262, -0.0257, -0.0255])
Batch 0/20:
reward seqs after 23 iterations: tensor([-0.0261], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 6 iterations: tensor([-0.0293], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 27 iterations: tensor([-0.0266], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 9 iterations: tensor([-0.0263], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 10 iterations: tensor([-0.0271], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 7 iterations: tensor([-0.0279], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 13 iterations: tensor([-0.0285], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 27 iterations: tensor([-0.0281], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 17 iterations: tensor([-0.0268], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 31 iterations: tensor([-0.0262], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 15 iterations: tensor([-0.0268], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 12 iterations: tensor([-0.0264], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 6 iterations: tensor([-0.0257], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 18 iterations: tensor([-0.0257], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 10 iterations: tensor([-0.0259], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 7 iterations: tensor([-0.0265], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 12 iterations: tensor([-0.0261], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 9 iterations: tensor([-0.0262], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 8 iterations: tensor([-0.0258], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 12 iterations: tensor([-0.0248], grad_fn=<CatBackward>)
Loss: 0.024846268817782402
Optimal set of params:
mid_point: tensor([[0.4797, 0.1400, 0.4562],
        [0.5121, 0.1400, 0.5752]])
angle: tensor([1.6207, 0.0485], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0109, 0.0113], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.4997, 0.1400, 0.8557, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.1126, 0.1400, 0.5946, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 44446 / 38938
[Open3D DEBUG] #   Got kernel density: 0.377303 (s), 5790.75 (MB) / 5790.75 (MB) / 5830 (MB)
[Open3D DEBUG] #     Got normal field: 0.210462 (s), 5793.45 (MB) / 5793.45 (MB) / 5830 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.631717e-05 / 2.503073e+00
[Open3D DEBUG] #       Finalized tree: 1.38989 (s), 5794.01 (MB) / 5794.01 (MB) / 5830 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.08192 (s), 5794.01 (MB) / 5794.01 (MB) / 5830 (MB)
[Open3D DEBUG] #Set point constraints: 1.04201 (s), 5794.01 (MB) / 5794.01 (MB) / 5830 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 521550 / 490912 / 105145
[Open3D DEBUG] Memory Usage: 5794.008 MB
[Open3D DEBUG] # Linear system solved: 10.5716 (s), 5794.01 (MB) / 5794.01 (MB) / 5830 (MB)
[Open3D DEBUG] Got average: 0.308753 (s), 5794.01 (MB) / 5794.01 (MB) / 5830 (MB)
[Open3D DEBUG] Iso-Value: 5.029457e-01 = 2.235392e+04 / 4.444600e+04
[Open3D DEBUG] #          Total Solve:      62.5 (s),    5800.9 (MB)
TriangleMesh with 78231 points and 156394 triangles.
EMD: tensor([0.0268], dtype=torch.float64)
Chamfer: tensor([0.0382], dtype=torch.float64)
=============== Iteration 2 -> model_loss: tensor([0.0248]); sim_loss: tensor([0.0280], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 45058 / 38988
[Open3D DEBUG] #   Got kernel density: 0.348535 (s), 5794.09 (MB) / 5800.88 (MB) / 5955 (MB)
[Open3D DEBUG] #     Got normal field: 0.252083 (s), 5794.39 (MB) / 5800.88 (MB) / 5955 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.248309e-05 / 2.364783e+00
[Open3D DEBUG] #       Finalized tree: 1.35454 (s), 5794.73 (MB) / 5800.88 (MB) / 5955 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.15636 (s), 5794.73 (MB) / 5800.88 (MB) / 5955 (MB)
[Open3D DEBUG] #Set point constraints: 1.14353 (s), 5794.73 (MB) / 5800.88 (MB) / 5955 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 522411 / 502520 / 94521
[Open3D DEBUG] Memory Usage: 5794.730 MB
[Open3D DEBUG] # Linear system solved: 12.0881 (s), 5794.73 (MB) / 5800.88 (MB) / 5955 (MB)
[Open3D DEBUG] Got average: 0.361633 (s), 5794.73 (MB) / 5800.88 (MB) / 5955 (MB)
[Open3D DEBUG] Iso-Value: 5.031608e-01 = 2.267142e+04 / 4.505800e+04
[Open3D DEBUG] #          Total Solve:      66.7 (s),    5802.9 (MB)
TriangleMesh with 78880 points and 157768 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0254, mean: -0.0316, std: 0.0024
Selected top reward seqs: tensor([-0.0281, -0.0280, -0.0279, -0.0279, -0.0278, -0.0278, -0.0278, -0.0278,
        -0.0274, -0.0274, -0.0274, -0.0273, -0.0273, -0.0271, -0.0270, -0.0269,
        -0.0269, -0.0267, -0.0266, -0.0254])
Batch 0/20:
reward seqs after 6 iterations: tensor([-0.0279], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 14 iterations: tensor([-0.0283], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 15 iterations: tensor([-0.0264], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 8 iterations: tensor([-0.0279], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 4 iterations: tensor([-0.0269], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 6 iterations: tensor([-0.0270], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 21 iterations: tensor([-0.0266], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 11 iterations: tensor([-0.0280], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 18 iterations: tensor([-0.0266], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 17 iterations: tensor([-0.0269], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 13 iterations: tensor([-0.0275], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 9 iterations: tensor([-0.0264], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 9 iterations: tensor([-0.0270], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 13 iterations: tensor([-0.0263], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 10 iterations: tensor([-0.0281], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 15 iterations: tensor([-0.0256], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 12 iterations: tensor([-0.0266], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 13 iterations: tensor([-0.0270], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 12 iterations: tensor([-0.0278], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 16 iterations: tensor([-0.0251], grad_fn=<CatBackward>)
Loss: 0.02513061836361885
Optimal set of params:
mid_point: tensor([[0.5191, 0.1400, 0.5589],
        [0.4533, 0.1400, 0.5797]])
angle: tensor([0.1373, 3.0964], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0101, 0.0101], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.1229, 0.1400, 0.6137, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.8529, 0.1400, 0.5978, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
=============== 2/2 ===============
[Open3D DEBUG] Input Points / Samples: 44578 / 37575
[Open3D DEBUG] #   Got kernel density: 0.207527 (s), 5901.76 (MB) / 5901.76 (MB) / 5955 (MB)
[Open3D DEBUG] #     Got normal field: 0.210467 (s), 5904.98 (MB) / 5904.98 (MB) / 5955 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.493241e-05 / 2.002997e+00
[Open3D DEBUG] #       Finalized tree: 1.34863 (s), 5905.29 (MB) / 5905.29 (MB) / 5955 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.88327 (s), 5905.29 (MB) / 5905.29 (MB) / 5955 (MB)
[Open3D DEBUG] #Set point constraints: 1.22743 (s), 5905.29 (MB) / 5905.29 (MB) / 5955 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 492290 / 499016 / 63601
[Open3D DEBUG] Memory Usage: 5905.285 MB
[Open3D DEBUG] # Linear system solved: 11.3106 (s), 5905.29 (MB) / 5905.29 (MB) / 5955 (MB)
[Open3D DEBUG] Got average: 0.304561 (s), 5905.29 (MB) / 5905.29 (MB) / 5955 (MB)
[Open3D DEBUG] Iso-Value: 5.025980e-01 = 2.240481e+04 / 4.457800e+04
[Open3D DEBUG] #          Total Solve:      58.5 (s),    5908.9 (MB)
TriangleMesh with 78194 points and 156358 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0245, mean: -0.0288, std: 0.0022
Selected top reward seqs: tensor([-0.0261, -0.0261, -0.0260, -0.0260, -0.0260, -0.0257, -0.0255, -0.0254,
        -0.0253, -0.0252, -0.0251, -0.0251, -0.0250, -0.0250, -0.0250, -0.0249,
        -0.0249, -0.0247, -0.0245, -0.0245])
Batch 0/20:
reward seqs after 19 iterations: tensor([-0.0261], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 6 iterations: tensor([-0.0266], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 19 iterations: tensor([-0.0259], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 12 iterations: tensor([-0.0256], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 24 iterations: tensor([-0.0267], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 8 iterations: tensor([-0.0263], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 28 iterations: tensor([-0.0245], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 17 iterations: tensor([-0.0256], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 12 iterations: tensor([-0.0257], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 22 iterations: tensor([-0.0249], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 8 iterations: tensor([-0.0256], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 11 iterations: tensor([-0.0255], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 18 iterations: tensor([-0.0252], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 16 iterations: tensor([-0.0255], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 10 iterations: tensor([-0.0251], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 5 iterations: tensor([-0.0252], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 5 iterations: tensor([-0.0251], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 6 iterations: tensor([-0.0244], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 12 iterations: tensor([-0.0245], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 7 iterations: tensor([-0.0247], grad_fn=<CatBackward>)
Loss: 0.02437754161655903
Optimal set of params:
mid_point: tensor([[0.5583, 0.1400, 0.5602]])
angle: tensor([3.1301], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0080], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.9583, 0.1400, 0.5648, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 45016 / 34705
[Open3D DEBUG] #   Got kernel density: 0.246678 (s), 5921.77 (MB) / 5921.77 (MB) / 5955 (MB)
[Open3D DEBUG] #     Got normal field: 0.209948 (s), 5923.41 (MB) / 5923.41 (MB) / 5955 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 3.064728e-05 / 1.379618e+00
[Open3D DEBUG] #       Finalized tree: 1.10650 (s), 5923.5 (MB) / 5923.5 (MB) / 5955 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.84767 (s), 5923.5 (MB) / 5923.5 (MB) / 5955 (MB)
[Open3D DEBUG] #Set point constraints: 0.796333 (s), 5923.5 (MB) / 5923.5 (MB) / 5955 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 432629 / 479296 / 15137
[Open3D DEBUG] Memory Usage: 5923.496 MB
[Open3D DEBUG] # Linear system solved: 7.58795 (s), 5923.5 (MB) / 5923.5 (MB) / 5955 (MB)
[Open3D DEBUG] Got average: 0.245893 (s), 5923.5 (MB) / 5923.5 (MB) / 5955 (MB)
[Open3D DEBUG] Iso-Value: 5.044338e-01 = 2.270759e+04 / 4.501600e+04
[Open3D DEBUG] #          Total Solve:      50.0 (s),    5928.6 (MB)
TriangleMesh with 71476 points and 142960 triangles.
EMD: tensor([0.0301], dtype=torch.float64)
Chamfer: tensor([0.0373], dtype=torch.float64)
=============== Iteration 3 -> model_loss: tensor([0.0244]); sim_loss: tensor([0.0308], dtype=torch.float64) ===============
torch.Size([4, 11, 14]) torch.Size([4, 40, 12])
Best init pose: tensor([[0.4832, 0.1400, 0.8390, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.6406, 0.1400, 0.8519, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.4997, 0.1400, 0.8557, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.1126, 0.1400, 0.5946, 1.0000, 0.0000, 0.0000, 0.0000]])
Best model loss: tensor([0.0248]); Best sim loss: tensor([0.0280], dtype=torch.float64)
Wrote profile results to control.py.lprof
