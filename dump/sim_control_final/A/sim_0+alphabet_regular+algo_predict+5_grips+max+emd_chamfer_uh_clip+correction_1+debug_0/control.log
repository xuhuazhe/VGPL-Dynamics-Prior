ENV:
  loss:
    soft_contact: False
    target_path: envs/assets/Chopsticks3D-v1.npy
    weight:
      contact: 1
      density: 10
      sdf: 10
  n_observed_particles: 200
PRIMITIVES: [{'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.35, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.65, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.13, 'r': 0.025, 'init_pos': '(0.5, 0.1, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.2, 0.2, 0.2)', 'friction': 15.0}]
RENDERER:
  bake_size: 6
  camera_pos: (0.5, 1.2, 4.0)
  camera_pos_1: (0.5, 2.5, 2.2)
  camera_pos_2: (0.5, 2.5, 2.2)
  camera_pos_3: (0.5, 2.5, 2.2)
  camera_pos_4: (0.5, 2.5, 2.2)
  camera_rot: (0.2, 0)
  camera_rot_1: (0.8, 0.0)
  camera_rot_2: (0.8, 0.0)
  camera_rot_3: (0.8, 0.0)
  camera_rot_4: (0.8, 0.0)
  dx: 0.006666666666666667
  image_res: (512, 512)
  light_direction: (2.0, 1.0, 0.7)
  max_num_particles: 1000000
  max_ray_depth: 2
  sdf_threshold: 0.20720000000000002
  spp: 50
  target_res: (64, 64, 64)
  use_directional_light: False
  use_roulette: False
  voxel_res: (168, 168, 168)
SHAPES: [{'shape': 'box', 'width': '(0.25, 0.2, 0.25)', 'init_pos': '(0.5, 0.1, 0.5)', 'n_particles': 20000, 'color': '((150<<8)+ (150<<16))'}]
SIMULATOR:
  E: 5000.0
  dim: 3
  dtype: float64
  gravity: (0, -5, 0)
  ground_friction: 100.0
  max_steps: 1024
  n_particles: 9000
  nu: 0.2
  quality: 1
  yield_stress: 4000.0
VARIANTS: [{'ENV': {'loss': {'target_path': 'envs/assets/gripper-v1.npy'}}}]
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.35, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.65, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 0
  scale: ()
color: (0.2, 0.2, 0.2)
friction: 15.0
h: 0.13
init_pos: (0.5, 0.1, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.025
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
{'width': (0.25, 0.2, 0.25), 'init_pos': (0.5, 0.1, 0.5), 'n_particles': 20000, 'color': 9868800}
Initialize Renderer
bake_size: 6  
camera_pos: (0.5, 1.2, 4.0)  
camera_pos_1: (0.5, 2.5, 2.2)  
camera_pos_2: (0.5, 2.5, 2.2)  
camera_pos_3: (0.5, 2.5, 2.2)  
camera_pos_4: (0.5, 2.5, 2.2)  
camera_rot: (0.2, 0)  
camera_rot_1: (0.8, 0.0)  
camera_rot_2: (0.8, 0.0)  
camera_rot_3: (0.8, 0.0)  
camera_rot_4: (0.8, 0.0)  
dx: 0.006666666666666667  
image_res: (512, 512)  
light_direction: (2.0, 1.0, 0.7)  
max_num_particles: 1000000  
max_ray_depth: 2  
sdf_threshold: 0.20720000000000002  
spp: 50  
target_res: (64, 64, 64)  
use_directional_light: False  
use_roulette: False  
voxel_res: (168, 168, 168)
[Taichi] materializing...
model_kp #params: 443560
GT shape: init pose: (1, 3, 11, 14); actions: (1, 3, 40, 12)
GT init pose: [[0.76359501 0.14       0.70473839 1.         0.         0.
  0.        ]
 [0.13751299 0.14       0.56262855 1.         0.         0.
  0.        ]
 [0.20403418 0.14       0.74794012 1.         0.         0.
  0.        ]]
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 49783 / 31818
[Open3D DEBUG] #   Got kernel density: 0.115628 (s), 4314.62 (MB) / 4314.62 (MB) / 4350 (MB)
[Open3D DEBUG] #     Got normal field: 0.0714309 (s), 4318.77 (MB) / 4318.77 (MB) / 4350 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 1.997654e-05 / 9.944923e-01
[Open3D DEBUG] #       Finalized tree: 0.552302 (s), 4321.22 (MB) / 4321.22 (MB) / 4350 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.834093 (s), 4321.22 (MB) / 4321.22 (MB) / 4350 (MB)
[Open3D DEBUG] #Set point constraints: 0.239473 (s), 4321.22 (MB) / 4321.22 (MB) / 4350 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 336414 / 382016 / 2457
[Open3D DEBUG] Memory Usage: 4321.223 MB
[Open3D DEBUG] # Linear system solved: 3.07454 (s), 4321.22 (MB) / 4321.22 (MB) / 4350 (MB)
[Open3D DEBUG] Got average: 0.107119 (s), 4321.22 (MB) / 4321.22 (MB) / 4350 (MB)
[Open3D DEBUG] Iso-Value: 4.966238e-01 = 2.472343e+04 / 4.978300e+04
[Open3D DEBUG] #          Total Solve:      23.6 (s),    4340.6 (MB)
TriangleMesh with 51100 points and 102188 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0285, mean: -0.0367, std: 0.0035
Selected idx: 147 with reward -0.02850637398660183
[Open3D DEBUG] Input Points / Samples: 50734 / 43580
[Open3D DEBUG] #   Got kernel density: 0.0821779 (s), 5379.55 (MB) / 5379.55 (MB) / 5418 (MB)
[Open3D DEBUG] #     Got normal field: 0.126806 (s), 5381.16 (MB) / 5381.16 (MB) / 5418 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.014816e-05 / 2.544217e+00
[Open3D DEBUG] #       Finalized tree: 0.833768 (s), 5381.52 (MB) / 5381.52 (MB) / 5418 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.834379 (s), 5381.52 (MB) / 5381.52 (MB) / 5418 (MB)
[Open3D DEBUG] #Set point constraints: 0.415629 (s), 5381.52 (MB) / 5381.52 (MB) / 5418 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 548311 / 519312 / 107329
[Open3D DEBUG] Memory Usage: 5381.516 MB
[Open3D DEBUG] # Linear system solved: 3.93274 (s), 5381.52 (MB) / 5381.52 (MB) / 5418 (MB)
[Open3D DEBUG] Got average: 0.13158 (s), 5381.52 (MB) / 5381.52 (MB) / 5418 (MB)
[Open3D DEBUG] Iso-Value: 5.013118e-01 = 2.543355e+04 / 5.073400e+04
[Open3D DEBUG] #          Total Solve:      27.5 (s),    5396.3 (MB)
TriangleMesh with 79564 points and 159046 triangles.
EMD: tensor([0.0363], dtype=torch.float64)
Chamfer: tensor([0.0408], dtype=torch.float64)
=============== Iteration 0 -> model_loss: tensor([0.0285]); sim_loss: tensor([0.0368], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 49521 / 43794
[Open3D DEBUG] #   Got kernel density: 0.193922 (s), 5396.88 (MB) / 5396.88 (MB) / 5433 (MB)
[Open3D DEBUG] #     Got normal field: 0.107275 (s), 5400.86 (MB) / 5400.86 (MB) / 5433 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.532378e-05 / 3.234899e+00
[Open3D DEBUG] #       Finalized tree: 0.837928 (s), 5400.93 (MB) / 5400.93 (MB) / 5433 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.832148 (s), 5400.93 (MB) / 5400.93 (MB) / 5433 (MB)
[Open3D DEBUG] #Set point constraints: 0.417196 (s), 5400.93 (MB) / 5400.93 (MB) / 5433 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 575100 / 513192 / 144065
[Open3D DEBUG] Memory Usage: 5400.934 MB
[Open3D DEBUG] # Linear system solved: 4.28763 (s), 5401.19 (MB) / 5401.19 (MB) / 5433 (MB)
[Open3D DEBUG] Got average: 0.113528 (s), 5401.19 (MB) / 5401.19 (MB) / 5433 (MB)
[Open3D DEBUG] Iso-Value: 5.015656e-01 = 2.483803e+04 / 4.952100e+04
[Open3D DEBUG] #          Total Solve:      28.5 (s),    5411.8 (MB)
TriangleMesh with 81425 points and 162673 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0278, mean: -0.0374, std: 0.0038
Selected idx: 70 with reward -0.027830742299556732
[Open3D DEBUG] Input Points / Samples: 51246 / 42538
[Open3D DEBUG] #   Got kernel density: 0.191278 (s), 5479.25 (MB) / 5479.25 (MB) / 5519 (MB)
[Open3D DEBUG] #     Got normal field: 0.108048 (s), 5481.29 (MB) / 5481.29 (MB) / 5519 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.052949e-05 / 2.076974e+00
[Open3D DEBUG] #       Finalized tree: 0.862864 (s), 5481.76 (MB) / 5481.76 (MB) / 5519 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.842041 (s), 5481.76 (MB) / 5481.76 (MB) / 5519 (MB)
[Open3D DEBUG] #Set point constraints: 0.468268 (s), 5481.76 (MB) / 5481.76 (MB) / 5519 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 554604 / 584024 / 49809
[Open3D DEBUG] Memory Usage: 5481.762 MB
[Open3D DEBUG] # Linear system solved: 4.23515 (s), 5481.76 (MB) / 5481.76 (MB) / 5519 (MB)
[Open3D DEBUG] Got average: 0.131149 (s), 5481.76 (MB) / 5481.76 (MB) / 5519 (MB)
[Open3D DEBUG] Iso-Value: 5.014749e-01 = 2.569858e+04 / 5.124600e+04
[Open3D DEBUG] #          Total Solve:      27.8 (s),    5494.3 (MB)
TriangleMesh with 90036 points and 180084 triangles.
EMD: tensor([0.0338], dtype=torch.float64)
Chamfer: tensor([0.0403], dtype=torch.float64)
=============== Iteration 1 -> model_loss: tensor([0.0278]); sim_loss: tensor([0.0345], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 50941 / 42063
[Open3D DEBUG] #   Got kernel density: 0.159712 (s), 5421.88 (MB) / 5494.32 (MB) / 5546 (MB)
[Open3D DEBUG] #     Got normal field: 0.105564 (s), 5422.62 (MB) / 5494.32 (MB) / 5546 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.124804e-05 / 2.101216e+00
[Open3D DEBUG] #       Finalized tree: 0.842945 (s), 5423.08 (MB) / 5494.32 (MB) / 5546 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.848413 (s), 5423.08 (MB) / 5494.32 (MB) / 5546 (MB)
[Open3D DEBUG] #Set point constraints: 0.462505 (s), 5423.08 (MB) / 5494.32 (MB) / 5546 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 534633 / 549584 / 61425
[Open3D DEBUG] Memory Usage: 5423.078 MB
[Open3D DEBUG] # Linear system solved: 4.05106 (s), 5423.08 (MB) / 5494.32 (MB) / 5546 (MB)
[Open3D DEBUG] Got average: 0.102459 (s), 5423.08 (MB) / 5494.32 (MB) / 5546 (MB)
[Open3D DEBUG] Iso-Value: 5.035486e-01 = 2.565127e+04 / 5.094100e+04
[Open3D DEBUG] #          Total Solve:      26.9 (s),    5494.3 (MB)
TriangleMesh with 84002 points and 168000 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0264, mean: -0.0356, std: 0.0035
Selected idx: 143 with reward -0.026411447674036026
[Open3D DEBUG] Input Points / Samples: 50483 / 43477
[Open3D DEBUG] #   Got kernel density: 0.196527 (s), 5547.81 (MB) / 5547.81 (MB) / 5587 (MB)
[Open3D DEBUG] #     Got normal field: 0.115748 (s), 5549.35 (MB) / 5549.35 (MB) / 5587 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.762828e-05 / 2.404418e+00
[Open3D DEBUG] #       Finalized tree: 0.757406 (s), 5549.49 (MB) / 5549.49 (MB) / 5587 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.894372 (s), 5549.49 (MB) / 5549.49 (MB) / 5587 (MB)
[Open3D DEBUG] #Set point constraints: 0.399566 (s), 5549.49 (MB) / 5549.49 (MB) / 5587 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 560365 / 554064 / 86353
[Open3D DEBUG] Memory Usage: 5549.492 MB
[Open3D DEBUG] # Linear system solved: 4.04645 (s), 5549.49 (MB) / 5549.49 (MB) / 5587 (MB)
[Open3D DEBUG] Got average: 0.127615 (s), 5549.49 (MB) / 5549.49 (MB) / 5587 (MB)
[Open3D DEBUG] Iso-Value: 5.000603e-01 = 2.524455e+04 / 5.048300e+04
[Open3D DEBUG] #          Total Solve:      27.7 (s),    5559.2 (MB)
TriangleMesh with 87379 points and 174738 triangles.
EMD: tensor([0.0312], dtype=torch.float64)
Chamfer: tensor([0.0386], dtype=torch.float64)
=============== Iteration 2 -> model_loss: tensor([0.0264]); sim_loss: tensor([0.0320], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 51786 / 44055
[Open3D DEBUG] #   Got kernel density: 0.155005 (s), 5577.02 (MB) / 5577.02 (MB) / 5709 (MB)
[Open3D DEBUG] #     Got normal field: 0.150823 (s), 5577.02 (MB) / 5577.02 (MB) / 5709 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.639315e-05 / 2.402516e+00
[Open3D DEBUG] #       Finalized tree: 0.897462 (s), 5577.12 (MB) / 5577.12 (MB) / 5709 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.903503 (s), 5577.12 (MB) / 5577.12 (MB) / 5709 (MB)
[Open3D DEBUG] #Set point constraints: 0.368022 (s), 5577.12 (MB) / 5577.12 (MB) / 5709 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 564348 / 559592 / 85377
[Open3D DEBUG] Memory Usage: 5577.121 MB
[Open3D DEBUG] # Linear system solved: 3.66648 (s), 5577.12 (MB) / 5577.12 (MB) / 5709 (MB)
[Open3D DEBUG] Got average: 0.101427 (s), 5577.12 (MB) / 5577.12 (MB) / 5709 (MB)
[Open3D DEBUG] Iso-Value: 5.021540e-01 = 2.600455e+04 / 5.178600e+04
[Open3D DEBUG] #          Total Solve:      26.0 (s),    5582.8 (MB)
TriangleMesh with 87111 points and 174222 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0276, mean: -0.0366, std: 0.0039
Selected idx: 95 with reward -0.027585469186306
=============== 2/2 ===============
[Open3D DEBUG] Input Points / Samples: 50947 / 43864
[Open3D DEBUG] #   Got kernel density: 0.188994 (s), 5665.62 (MB) / 5665.62 (MB) / 5709 (MB)
[Open3D DEBUG] #     Got normal field: 0.111288 (s), 5669.06 (MB) / 5669.06 (MB) / 5709 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.700003e-05 / 2.394511e+00
[Open3D DEBUG] #       Finalized tree: 0.922985 (s), 5669.33 (MB) / 5669.33 (MB) / 5709 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.870040 (s), 5669.33 (MB) / 5669.33 (MB) / 5709 (MB)
[Open3D DEBUG] #Set point constraints: 0.45865 (s), 5669.33 (MB) / 5669.33 (MB) / 5709 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 568863 / 564792 / 85337
[Open3D DEBUG] Memory Usage: 5669.328 MB
[Open3D DEBUG] # Linear system solved: 4.87921 (s), 5669.33 (MB) / 5669.33 (MB) / 5709 (MB)
[Open3D DEBUG] Got average: 0.150571 (s), 5669.33 (MB) / 5669.33 (MB) / 5709 (MB)
[Open3D DEBUG] Iso-Value: 5.026448e-01 = 2.560825e+04 / 5.094700e+04
[Open3D DEBUG] #          Total Solve:      29.6 (s),    5673.8 (MB)
TriangleMesh with 87892 points and 175764 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0305, mean: -0.0372, std: 0.0028
Selected idx: 188 with reward -0.03049120120704174
[Open3D DEBUG] Input Points / Samples: 50696 / 44224
[Open3D DEBUG] #   Got kernel density: 0.191039 (s), 5625.93 (MB) / 5673.77 (MB) / 5709 (MB)
[Open3D DEBUG] #     Got normal field: 0.105741 (s), 5628.52 (MB) / 5673.77 (MB) / 5709 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.076767e-05 / 2.573718e+00
[Open3D DEBUG] #       Finalized tree: 0.901460 (s), 5628.79 (MB) / 5673.77 (MB) / 5709 (MB)
[Open3D DEBUG] #  Set FEM constraints: 0.794296 (s), 5628.79 (MB) / 5673.77 (MB) / 5709 (MB)
[Open3D DEBUG] #Set point constraints: 0.505302 (s), 5628.79 (MB) / 5673.77 (MB) / 5709 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 570396 / 552864 / 99017
[Open3D DEBUG] Memory Usage: 5628.785 MB
[Open3D DEBUG] # Linear system solved: 4.05057 (s), 5628.79 (MB) / 5673.77 (MB) / 5709 (MB)
[Open3D DEBUG] Got average: 0.109160 (s), 5628.79 (MB) / 5673.77 (MB) / 5709 (MB)
[Open3D DEBUG] Iso-Value: 5.011923e-01 = 2.540844e+04 / 5.069600e+04
[Open3D DEBUG] #          Total Solve:      27.9 (s),    5673.8 (MB)
TriangleMesh with 88433 points and 176846 triangles.
EMD: tensor([0.0321], dtype=torch.float64)
Chamfer: tensor([0.0389], dtype=torch.float64)
=============== Iteration 3 -> model_loss: tensor([0.0305]); sim_loss: tensor([0.0328], dtype=torch.float64) ===============
torch.Size([4, 11, 14]) torch.Size([4, 40, 12])
Best init pose: tensor([[0.8372, 0.1400, 0.7100, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.9240, 0.1400, 0.6589, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.8990, 0.1400, 0.6660, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.3300, 0.1400, 0.8513, 1.0000, 0.0000, 0.0000, 0.0000]])
Best model loss: tensor([0.0264]); Best sim loss: tensor([0.0320], dtype=torch.float64)
Wrote profile results to control.py.lprof
