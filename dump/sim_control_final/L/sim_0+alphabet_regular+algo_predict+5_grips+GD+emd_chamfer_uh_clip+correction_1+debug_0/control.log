ENV:
  loss:
    soft_contact: False
    target_path: envs/assets/Chopsticks3D-v1.npy
    weight:
      contact: 1
      density: 10
      sdf: 10
  n_observed_particles: 200
PRIMITIVES: [{'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.35, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.65, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.13, 'r': 0.025, 'init_pos': '(0.5, 0.1, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.2, 0.2, 0.2)', 'friction': 15.0}]
RENDERER:
  bake_size: 6
  camera_pos: (0.5, 1.2, 4.0)
  camera_pos_1: (0.5, 2.5, 2.2)
  camera_pos_2: (0.5, 2.5, 2.2)
  camera_pos_3: (0.5, 2.5, 2.2)
  camera_pos_4: (0.5, 2.5, 2.2)
  camera_rot: (0.2, 0)
  camera_rot_1: (0.8, 0.0)
  camera_rot_2: (0.8, 0.0)
  camera_rot_3: (0.8, 0.0)
  camera_rot_4: (0.8, 0.0)
  dx: 0.006666666666666667
  image_res: (512, 512)
  light_direction: (2.0, 1.0, 0.7)
  max_num_particles: 1000000
  max_ray_depth: 2
  sdf_threshold: 0.20720000000000002
  spp: 50
  target_res: (64, 64, 64)
  use_directional_light: False
  use_roulette: False
  voxel_res: (168, 168, 168)
SHAPES: [{'shape': 'box', 'width': '(0.25, 0.2, 0.25)', 'init_pos': '(0.5, 0.1, 0.5)', 'n_particles': 20000, 'color': '((150<<8)+ (150<<16))'}]
SIMULATOR:
  E: 5000.0
  dim: 3
  dtype: float64
  gravity: (0, -5, 0)
  ground_friction: 100.0
  max_steps: 1024
  n_particles: 9000
  nu: 0.2
  quality: 1
  yield_stress: 4000.0
VARIANTS: [{'ENV': {'loss': {'target_path': 'envs/assets/gripper-v1.npy'}}}]
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.35, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.65, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 0
  scale: ()
color: (0.2, 0.2, 0.2)
friction: 15.0
h: 0.13
init_pos: (0.5, 0.1, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.025
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
{'width': (0.25, 0.2, 0.25), 'init_pos': (0.5, 0.1, 0.5), 'n_particles': 20000, 'color': 9868800}
Initialize Renderer
bake_size: 6  
camera_pos: (0.5, 1.2, 4.0)  
camera_pos_1: (0.5, 2.5, 2.2)  
camera_pos_2: (0.5, 2.5, 2.2)  
camera_pos_3: (0.5, 2.5, 2.2)  
camera_pos_4: (0.5, 2.5, 2.2)  
camera_rot: (0.2, 0)  
camera_rot_1: (0.8, 0.0)  
camera_rot_2: (0.8, 0.0)  
camera_rot_3: (0.8, 0.0)  
camera_rot_4: (0.8, 0.0)  
dx: 0.006666666666666667  
image_res: (512, 512)  
light_direction: (2.0, 1.0, 0.7)  
max_num_particles: 1000000  
max_ray_depth: 2  
sdf_threshold: 0.20720000000000002  
spp: 50  
target_res: (64, 64, 64)  
use_directional_light: False  
use_roulette: False  
voxel_res: (168, 168, 168)
[Taichi] materializing...
model_kp #params: 443560
GT shape: init pose: (1, 3, 11, 14); actions: (1, 3, 40, 12)
GT init pose: [[0.49119963 0.14       0.92617013 1.         0.         0.
  0.        ]
 [0.90975371 0.14       0.62744569 1.         0.         0.
  0.        ]
 [0.66744627 0.14       0.8448659  1.         0.         0.
  0.        ]]
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 43670 / 28229
[Open3D DEBUG] #   Got kernel density: 0.205479 (s), 4326.37 (MB) / 4326.37 (MB) / 4347 (MB)
[Open3D DEBUG] #     Got normal field: 0.078335 (s), 4331.48 (MB) / 4331.48 (MB) / 4347 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 2.048150e-05 / 8.944272e-01
[Open3D DEBUG] #       Finalized tree: 1.14817 (s), 4332.75 (MB) / 4332.75 (MB) / 4347 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.83539 (s), 4333.05 (MB) / 4333.05 (MB) / 4347 (MB)
[Open3D DEBUG] #Set point constraints: 0.583361 (s), 4333.05 (MB) / 4333.05 (MB) / 4347 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 309163 / 351456 / 1873
[Open3D DEBUG] Memory Usage: 4333.047 MB
[Open3D DEBUG] # Linear system solved: 7.7226 (s), 4333.05 (MB) / 4333.05 (MB) / 4347 (MB)
[Open3D DEBUG] Got average: 0.313787 (s), 4333.05 (MB) / 4333.05 (MB) / 4347 (MB)
[Open3D DEBUG] Iso-Value: 5.039394e-01 = 2.200704e+04 / 4.367000e+04
[Open3D DEBUG] #          Total Solve:      52.3 (s),    4346.6 (MB)
TriangleMesh with 45345 points and 90678 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0460, mean: -0.0542, std: 0.0035
Selected top reward seqs: tensor([-0.0489, -0.0489, -0.0489, -0.0489, -0.0487, -0.0485, -0.0483, -0.0482,
        -0.0480, -0.0480, -0.0478, -0.0477, -0.0475, -0.0473, -0.0473, -0.0470,
        -0.0469, -0.0466, -0.0465, -0.0460])
Batch 0/20:
reward seqs after 10 iterations: tensor([-0.0488], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 27 iterations: tensor([-0.0483], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 16 iterations: tensor([-0.0472], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 12 iterations: tensor([-0.0481], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 5 iterations: tensor([-0.0468], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 15 iterations: tensor([-0.0462], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 17 iterations: tensor([-0.0475], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 11 iterations: tensor([-0.0471], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 27 iterations: tensor([-0.0475], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 4 iterations: tensor([-0.0459], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 15 iterations: tensor([-0.0469], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 13 iterations: tensor([-0.0470], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 12 iterations: tensor([-0.0468], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 3 iterations: tensor([-0.0470], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 8 iterations: tensor([-0.0469], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 8 iterations: tensor([-0.0464], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 9 iterations: tensor([-0.0454], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 9 iterations: tensor([-0.0467], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 9 iterations: tensor([-0.0451], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 11 iterations: tensor([-0.0458], grad_fn=<CatBackward>)
Loss: 0.0450601726770401
Optimal set of params:
mid_point: tensor([[0.5082, 0.1400, 0.5097],
        [0.4414, 0.1400, 0.4247]])
angle: tensor([2.7541, 2.3723], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0092], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.8786, 0.1400, 0.6609, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.7288, 0.1400, 0.7030, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 44552 / 38554
[Open3D DEBUG] #   Got kernel density: 0.253673 (s), 5638.98 (MB) / 5638.98 (MB) / 5670 (MB)
[Open3D DEBUG] #     Got normal field: 0.145272 (s), 5648.71 (MB) / 5648.71 (MB) / 5670 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.542910e-05 / 2.469477e+00
[Open3D DEBUG] #       Finalized tree: 1.31289 (s), 5649.95 (MB) / 5649.95 (MB) / 5670 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.82023 (s), 5649.95 (MB) / 5649.95 (MB) / 5670 (MB)
[Open3D DEBUG] #Set point constraints: 0.862276 (s), 5649.95 (MB) / 5649.95 (MB) / 5670 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 497981 / 458264 / 110857
[Open3D DEBUG] Memory Usage: 5649.949 MB
[Open3D DEBUG] # Linear system solved: 10.7872 (s), 5649.96 (MB) / 5649.96 (MB) / 5670 (MB)
[Open3D DEBUG] Got average: 0.291892 (s), 5649.96 (MB) / 5649.96 (MB) / 5670 (MB)
[Open3D DEBUG] Iso-Value: 5.021273e-01 = 2.237078e+04 / 4.455200e+04
[Open3D DEBUG] #          Total Solve:      63.2 (s),    5663.4 (MB)
TriangleMesh with 69261 points and 138386 triangles.
EMD: tensor([0.0438], dtype=torch.float64)
Chamfer: tensor([0.0506], dtype=torch.float64)
=============== Iteration 0 -> model_loss: tensor([0.0451]); sim_loss: tensor([0.0445], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 44182 / 38755
[Open3D DEBUG] #   Got kernel density: 0.326229 (s), 5655.86 (MB) / 5663.45 (MB) / 5688 (MB)
[Open3D DEBUG] #     Got normal field: 0.517233 (s), 5660.09 (MB) / 5663.45 (MB) / 5688 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.224879e-05 / 2.750276e+00
[Open3D DEBUG] #       Finalized tree: 1.30964 (s), 5660.46 (MB) / 5663.45 (MB) / 5688 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.80204 (s), 5660.46 (MB) / 5663.45 (MB) / 5688 (MB)
[Open3D DEBUG] #Set point constraints: 0.946804 (s), 5660.46 (MB) / 5663.45 (MB) / 5688 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 511036 / 461328 / 122713
[Open3D DEBUG] Memory Usage: 5660.465 MB
[Open3D DEBUG] # Linear system solved: 9.43968 (s), 5660.58 (MB) / 5663.45 (MB) / 5688 (MB)
[Open3D DEBUG] Got average: 0.292654 (s), 5660.58 (MB) / 5663.45 (MB) / 5688 (MB)
[Open3D DEBUG] Iso-Value: 5.005936e-01 = 2.211723e+04 / 4.418200e+04
[Open3D DEBUG] #          Total Solve:      60.8 (s),    5670.3 (MB)
TriangleMesh with 71791 points and 143472 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0446, mean: -0.0522, std: 0.0036
Selected top reward seqs: tensor([-0.0474, -0.0473, -0.0471, -0.0471, -0.0468, -0.0468, -0.0467, -0.0467,
        -0.0467, -0.0457, -0.0456, -0.0455, -0.0455, -0.0454, -0.0453, -0.0453,
        -0.0449, -0.0448, -0.0448, -0.0446])
Batch 0/20:
reward seqs after 9 iterations: tensor([-0.0464], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 16 iterations: tensor([-0.0457], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 26 iterations: tensor([-0.0471], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 22 iterations: tensor([-0.0454], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 2 iterations: tensor([-0.0453], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 9 iterations: tensor([-0.0466], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 10 iterations: tensor([-0.0464], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 9 iterations: tensor([-0.0462], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 12 iterations: tensor([-0.0457], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 7 iterations: tensor([-0.0466], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 6 iterations: tensor([-0.0453], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 12 iterations: tensor([-0.0447], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 9 iterations: tensor([-0.0444], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 26 iterations: tensor([-0.0459], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 15 iterations: tensor([-0.0450], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 9 iterations: tensor([-0.0436], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 6 iterations: tensor([-0.0440], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 15 iterations: tensor([-0.0444], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 9 iterations: tensor([-0.0463], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 15 iterations: tensor([-0.0448], grad_fn=<CatBackward>)
Loss: 0.04356608912348747
Optimal set of params:
mid_point: tensor([[0.5530, 0.1400, 0.4194],
        [0.5627, 0.1400, 0.4426]])
angle: tensor([1.7810, 1.7701], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0113], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.6364, 0.1400, 0.8106, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.6419, 0.1400, 0.8346, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 45410 / 39495
[Open3D DEBUG] #   Got kernel density: 0.221797 (s), 5736.32 (MB) / 5736.32 (MB) / 5769 (MB)
[Open3D DEBUG] #     Got normal field: 0.180846 (s), 5740.34 (MB) / 5740.34 (MB) / 5769 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.649593e-05 / 2.565480e+00
[Open3D DEBUG] #       Finalized tree: 1.31231 (s), 5740.54 (MB) / 5740.54 (MB) / 5769 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.88315 (s), 5740.54 (MB) / 5740.54 (MB) / 5769 (MB)
[Open3D DEBUG] #Set point constraints: 1.23545 (s), 5740.54 (MB) / 5740.54 (MB) / 5769 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 511939 / 468048 / 117025
[Open3D DEBUG] Memory Usage: 5740.535 MB
[Open3D DEBUG] # Linear system solved: 10.1986 (s), 5740.54 (MB) / 5740.54 (MB) / 5769 (MB)
[Open3D DEBUG] Got average: 0.322355 (s), 5740.54 (MB) / 5740.54 (MB) / 5769 (MB)
[Open3D DEBUG] Iso-Value: 5.024981e-01 = 2.281844e+04 / 4.541000e+04
[Open3D DEBUG] #          Total Solve:      63.5 (s),    5747.3 (MB)
TriangleMesh with 71777 points and 143470 triangles.
EMD: tensor([0.0447], dtype=torch.float64)
Chamfer: tensor([0.0502], dtype=torch.float64)
=============== Iteration 1 -> model_loss: tensor([0.0436]); sim_loss: tensor([0.0452], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 44398 / 37620
[Open3D DEBUG] #   Got kernel density: 0.369879 (s), 5740.56 (MB) / 5747.27 (MB) / 5807 (MB)
[Open3D DEBUG] #     Got normal field: 0.203751 (s), 5740.96 (MB) / 5747.27 (MB) / 5807 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.969988e-05 / 2.206575e+00
[Open3D DEBUG] #       Finalized tree: 1.52808 (s), 5741.35 (MB) / 5747.27 (MB) / 5807 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.94335 (s), 5741.35 (MB) / 5747.27 (MB) / 5807 (MB)
[Open3D DEBUG] #Set point constraints: 0.880871 (s), 5741.35 (MB) / 5747.27 (MB) / 5807 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 478920 / 454448 / 92889
[Open3D DEBUG] Memory Usage: 5741.352 MB
[Open3D DEBUG] # Linear system solved: 9.48086 (s), 5741.54 (MB) / 5747.27 (MB) / 5807 (MB)
[Open3D DEBUG] Got average: 0.316593 (s), 5741.54 (MB) / 5747.27 (MB) / 5807 (MB)
[Open3D DEBUG] Iso-Value: 5.026384e-01 = 2.231614e+04 / 4.439800e+04
[Open3D DEBUG] #          Total Solve:      62.8 (s),    5750.4 (MB)
TriangleMesh with 69136 points and 138224 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0366, mean: -0.0481, std: 0.0044
Selected top reward seqs: tensor([-0.0422, -0.0422, -0.0419, -0.0418, -0.0417, -0.0416, -0.0416, -0.0415,
        -0.0413, -0.0410, -0.0410, -0.0407, -0.0405, -0.0404, -0.0402, -0.0401,
        -0.0399, -0.0387, -0.0367, -0.0366])
Batch 0/20:
reward seqs after 7 iterations: tensor([-0.0407], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 21 iterations: tensor([-0.0397], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 18 iterations: tensor([-0.0390], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 2 iterations: tensor([-0.0414], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 5 iterations: tensor([-0.0407], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 8 iterations: tensor([-0.0389], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 4 iterations: tensor([-0.0377], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 13 iterations: tensor([-0.0394], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 20 iterations: tensor([-0.0398], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 12 iterations: tensor([-0.0404], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 26 iterations: tensor([-0.0387], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 15 iterations: tensor([-0.0391], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 18 iterations: tensor([-0.0399], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 14 iterations: tensor([-0.0386], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 11 iterations: tensor([-0.0392], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 11 iterations: tensor([-0.0400], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 11 iterations: tensor([-0.0378], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 4 iterations: tensor([-0.0384], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 14 iterations: tensor([-0.0353], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 3 iterations: tensor([-0.0367], grad_fn=<CatBackward>)
Loss: 0.03530707582831383
Optimal set of params:
mid_point: tensor([[0.4930, 0.1400, 0.5445],
        [0.4843, 0.1400, 0.4586]])
angle: tensor([0.3135, 2.1413], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0109, 0.0103], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.1124, 0.1400, 0.6679, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.7003, 0.1400, 0.7952, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 45650 / 40385
[Open3D DEBUG] #   Got kernel density: 0.390556 (s), 5793.06 (MB) / 5793.06 (MB) / 5833 (MB)
[Open3D DEBUG] #     Got normal field: 0.261628 (s), 5794.52 (MB) / 5794.52 (MB) / 5833 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.180366e-05 / 2.821337e+00
[Open3D DEBUG] #       Finalized tree: 1.75704 (s), 5794.82 (MB) / 5794.82 (MB) / 5833 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.04467 (s), 5794.85 (MB) / 5794.85 (MB) / 5833 (MB)
[Open3D DEBUG] #Set point constraints: 1.21513 (s), 5794.85 (MB) / 5794.85 (MB) / 5833 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 545469 / 497560 / 125833
[Open3D DEBUG] Memory Usage: 5794.848 MB
[Open3D DEBUG] # Linear system solved: 12.6401 (s), 5794.86 (MB) / 5794.86 (MB) / 5833 (MB)
[Open3D DEBUG] Got average: 0.473456 (s), 5794.86 (MB) / 5794.86 (MB) / 5833 (MB)
[Open3D DEBUG] Iso-Value: 5.011172e-01 = 2.287600e+04 / 4.565000e+04
[Open3D DEBUG] #          Total Solve:      68.1 (s),    5801.9 (MB)
TriangleMesh with 78112 points and 156130 triangles.
EMD: tensor([0.0398], dtype=torch.float64)
Chamfer: tensor([0.0470], dtype=torch.float64)
=============== Iteration 2 -> model_loss: tensor([0.0353]); sim_loss: tensor([0.0405], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 45500 / 39668
[Open3D DEBUG] #   Got kernel density: 0.223684 (s), 5795.79 (MB) / 5801.92 (MB) / 5960 (MB)
[Open3D DEBUG] #     Got normal field: 0.188153 (s), 5797.57 (MB) / 5801.92 (MB) / 5960 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.600798e-05 / 2.548363e+00
[Open3D DEBUG] #       Finalized tree: 1.37593 (s), 5797.61 (MB) / 5801.92 (MB) / 5960 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.98802 (s), 5797.61 (MB) / 5801.92 (MB) / 5960 (MB)
[Open3D DEBUG] #Set point constraints: 1.01215 (s), 5797.61 (MB) / 5801.92 (MB) / 5960 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 520493 / 482768 / 112081
[Open3D DEBUG] Memory Usage: 5797.613 MB
[Open3D DEBUG] # Linear system solved: 9.98847 (s), 5797.61 (MB) / 5801.92 (MB) / 5960 (MB)
[Open3D DEBUG] Got average: 0.270455 (s), 5797.61 (MB) / 5801.92 (MB) / 5960 (MB)
[Open3D DEBUG] Iso-Value: 5.022629e-01 = 2.285296e+04 / 4.550000e+04
[Open3D DEBUG] #          Total Solve:      61.9 (s),    5807.3 (MB)
TriangleMesh with 75071 points and 150078 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0360, mean: -0.0470, std: 0.0039
Selected top reward seqs: tensor([-0.0420, -0.0420, -0.0415, -0.0415, -0.0412, -0.0411, -0.0410, -0.0409,
        -0.0408, -0.0403, -0.0402, -0.0402, -0.0402, -0.0401, -0.0400, -0.0397,
        -0.0397, -0.0376, -0.0373, -0.0360])
Batch 0/20:
reward seqs after 30 iterations: tensor([-0.0367], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 13 iterations: tensor([-0.0410], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 13 iterations: tensor([-0.0400], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 8 iterations: tensor([-0.0391], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 26 iterations: tensor([-0.0374], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 5 iterations: tensor([-0.0397], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 7 iterations: tensor([-0.0404], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 6 iterations: tensor([-0.0359], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 24 iterations: tensor([-0.0378], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 2 iterations: tensor([-0.0370], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 21 iterations: tensor([-0.0390], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 9 iterations: tensor([-0.0382], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 10 iterations: tensor([-0.0378], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 17 iterations: tensor([-0.0370], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 17 iterations: tensor([-0.0364], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 20 iterations: tensor([-0.0352], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 14 iterations: tensor([-0.0365], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 6 iterations: tensor([-0.0360], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 22 iterations: tensor([-0.0358], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 10 iterations: tensor([-0.0350], grad_fn=<CatBackward>)
Loss: 0.03496786579489708
Optimal set of params:
mid_point: tensor([[0.4433, 0.1400, 0.5551],
        [0.4316, 0.1400, 0.5655]])
angle: tensor([2.7249, 3.0811], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0110, 0.0110], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.8091, 0.1400, 0.7170, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.8309, 0.1400, 0.5896, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
=============== 2/2 ===============
[Open3D DEBUG] Input Points / Samples: 46191 / 40621
[Open3D DEBUG] #   Got kernel density: 0.313885 (s), 5915.18 (MB) / 5915.18 (MB) / 5960 (MB)
[Open3D DEBUG] #     Got normal field: 0.1877 (s), 5917.41 (MB) / 5917.41 (MB) / 5960 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.815224e-05 / 2.686110e+00
[Open3D DEBUG] #       Finalized tree: 1.36342 (s), 5917.82 (MB) / 5917.82 (MB) / 5960 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.8478 (s), 5917.82 (MB) / 5917.82 (MB) / 5960 (MB)
[Open3D DEBUG] #Set point constraints: 1.03047 (s), 5917.82 (MB) / 5917.82 (MB) / 5960 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 544874 / 502448 / 120265
[Open3D DEBUG] Memory Usage: 5917.820 MB
[Open3D DEBUG] # Linear system solved: 12.3101 (s), 5917.82 (MB) / 5917.82 (MB) / 5960 (MB)
[Open3D DEBUG] Got average: 0.305768 (s), 5917.82 (MB) / 5917.82 (MB) / 5960 (MB)
[Open3D DEBUG] Iso-Value: 5.027805e-01 = 2.322393e+04 / 4.619100e+04
[Open3D DEBUG] #          Total Solve:      65.3 (s),    5921.9 (MB)
TriangleMesh with 77614 points and 155144 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0344, mean: -0.0430, std: 0.0042
Selected top reward seqs: tensor([-0.0375, -0.0375, -0.0375, -0.0375, -0.0375, -0.0374, -0.0374, -0.0374,
        -0.0372, -0.0372, -0.0371, -0.0370, -0.0370, -0.0369, -0.0367, -0.0366,
        -0.0353, -0.0353, -0.0346, -0.0344])
Batch 0/20:
reward seqs after 27 iterations: tensor([-0.0374], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 28 iterations: tensor([-0.0373], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 18 iterations: tensor([-0.0371], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 6 iterations: tensor([-0.0373], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 2 iterations: tensor([-0.0374], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 19 iterations: tensor([-0.0354], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 24 iterations: tensor([-0.0374], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 11 iterations: tensor([-0.0373], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 18 iterations: tensor([-0.0362], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 22 iterations: tensor([-0.0371], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 20 iterations: tensor([-0.0366], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 9 iterations: tensor([-0.0370], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 24 iterations: tensor([-0.0364], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 2 iterations: tensor([-0.0369], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 12 iterations: tensor([-0.0368], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 11 iterations: tensor([-0.0345], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 11 iterations: tensor([-0.0334], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 23 iterations: tensor([-0.0339], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 8 iterations: tensor([-0.0340], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 18 iterations: tensor([-0.0345], grad_fn=<CatBackward>)
Loss: 0.033447347581386566
Optimal set of params:
mid_point: tensor([[0.4742, 0.1400, 0.5781]])
angle: tensor([0.2764], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.0894, 0.1400, 0.6873, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 44988 / 39984
[Open3D DEBUG] #   Got kernel density: 0.307463 (s), 5962.31 (MB) / 5962.31 (MB) / 5995 (MB)
[Open3D DEBUG] #     Got normal field: 0.423737 (s), 5964.73 (MB) / 5964.73 (MB) / 5995 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.079897e-05 / 2.735224e+00
[Open3D DEBUG] #       Finalized tree: 1.43519 (s), 5965.03 (MB) / 5965.03 (MB) / 5995 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.98206 (s), 5965.03 (MB) / 5965.03 (MB) / 5995 (MB)
[Open3D DEBUG] #Set point constraints: 1.25658 (s), 5965.03 (MB) / 5965.03 (MB) / 5995 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 544965 / 500640 / 122177
[Open3D DEBUG] Memory Usage: 5965.031 MB
[Open3D DEBUG] # Linear system solved: 9.36142 (s), 5965.03 (MB) / 5965.03 (MB) / 5995 (MB)
[Open3D DEBUG] Got average: 0.317194 (s), 5965.03 (MB) / 5965.03 (MB) / 5995 (MB)
[Open3D DEBUG] Iso-Value: 5.014467e-01 = 2.255909e+04 / 4.498800e+04
[Open3D DEBUG] #          Total Solve:      59.8 (s),    5970.6 (MB)
TriangleMesh with 78808 points and 157532 triangles.
EMD: tensor([0.0344], dtype=torch.float64)
Chamfer: tensor([0.0434], dtype=torch.float64)
=============== Iteration 3 -> model_loss: tensor([0.0334]); sim_loss: tensor([0.0353], dtype=torch.float64) ===============
torch.Size([5, 11, 14]) torch.Size([5, 40, 12])
Best init pose: tensor([[0.8786, 0.1400, 0.6609, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.6364, 0.1400, 0.8106, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.1124, 0.1400, 0.6679, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.8091, 0.1400, 0.7170, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.0894, 0.1400, 0.6873, 1.0000, 0.0000, 0.0000, 0.0000]])
Best model loss: tensor([0.0334]); Best sim loss: tensor([0.0353], dtype=torch.float64)
Wrote profile results to control.py.lprof
