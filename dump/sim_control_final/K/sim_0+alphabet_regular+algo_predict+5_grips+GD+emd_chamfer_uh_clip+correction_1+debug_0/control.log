ENV:
  loss:
    soft_contact: False
    target_path: envs/assets/Chopsticks3D-v1.npy
    weight:
      contact: 1
      density: 10
      sdf: 10
  n_observed_particles: 200
PRIMITIVES: [{'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.35, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.65, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.13, 'r': 0.025, 'init_pos': '(0.5, 0.1, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.2, 0.2, 0.2)', 'friction': 15.0}]
RENDERER:
  bake_size: 6
  camera_pos: (0.5, 1.2, 4.0)
  camera_pos_1: (0.5, 2.5, 2.2)
  camera_pos_2: (0.5, 2.5, 2.2)
  camera_pos_3: (0.5, 2.5, 2.2)
  camera_pos_4: (0.5, 2.5, 2.2)
  camera_rot: (0.2, 0)
  camera_rot_1: (0.8, 0.0)
  camera_rot_2: (0.8, 0.0)
  camera_rot_3: (0.8, 0.0)
  camera_rot_4: (0.8, 0.0)
  dx: 0.006666666666666667
  image_res: (512, 512)
  light_direction: (2.0, 1.0, 0.7)
  max_num_particles: 1000000
  max_ray_depth: 2
  sdf_threshold: 0.20720000000000002
  spp: 50
  target_res: (64, 64, 64)
  use_directional_light: False
  use_roulette: False
  voxel_res: (168, 168, 168)
SHAPES: [{'shape': 'box', 'width': '(0.25, 0.2, 0.25)', 'init_pos': '(0.5, 0.1, 0.5)', 'n_particles': 20000, 'color': '((150<<8)+ (150<<16))'}]
SIMULATOR:
  E: 5000.0
  dim: 3
  dtype: float64
  gravity: (0, -5, 0)
  ground_friction: 100.0
  max_steps: 1024
  n_particles: 9000
  nu: 0.2
  quality: 1
  yield_stress: 4000.0
VARIANTS: [{'ENV': {'loss': {'target_path': 'envs/assets/gripper-v1.npy'}}}]
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.35, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.65, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 0
  scale: ()
color: (0.2, 0.2, 0.2)
friction: 15.0
h: 0.13
init_pos: (0.5, 0.1, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.025
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
{'width': (0.25, 0.2, 0.25), 'init_pos': (0.5, 0.1, 0.5), 'n_particles': 20000, 'color': 9868800}
Initialize Renderer
bake_size: 6  
camera_pos: (0.5, 1.2, 4.0)  
camera_pos_1: (0.5, 2.5, 2.2)  
camera_pos_2: (0.5, 2.5, 2.2)  
camera_pos_3: (0.5, 2.5, 2.2)  
camera_pos_4: (0.5, 2.5, 2.2)  
camera_rot: (0.2, 0)  
camera_rot_1: (0.8, 0.0)  
camera_rot_2: (0.8, 0.0)  
camera_rot_3: (0.8, 0.0)  
camera_rot_4: (0.8, 0.0)  
dx: 0.006666666666666667  
image_res: (512, 512)  
light_direction: (2.0, 1.0, 0.7)  
max_num_particles: 1000000  
max_ray_depth: 2  
sdf_threshold: 0.20720000000000002  
spp: 50  
target_res: (64, 64, 64)  
use_directional_light: False  
use_roulette: False  
voxel_res: (168, 168, 168)
[Taichi] materializing...
model_kp #params: 443560
GT shape: init pose: (1, 3, 11, 14); actions: (1, 3, 40, 12)
GT init pose: [[0.49119963 0.14       0.92617013 1.         0.         0.
  0.        ]
 [0.90975371 0.14       0.62744569 1.         0.         0.
  0.        ]
 [0.66744627 0.14       0.8448659  1.         0.         0.
  0.        ]]
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 43670 / 28229
[Open3D DEBUG] #   Got kernel density: 0.222673 (s), 4341.45 (MB) / 4341.45 (MB) / 4362 (MB)
[Open3D DEBUG] #     Got normal field: 0.164337 (s), 4349.09 (MB) / 4349.09 (MB) / 4362 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 2.048152e-05 / 8.944281e-01
[Open3D DEBUG] #       Finalized tree: 1.20251 (s), 4350.62 (MB) / 4350.62 (MB) / 4362 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.94657 (s), 4350.62 (MB) / 4350.62 (MB) / 4362 (MB)
[Open3D DEBUG] #Set point constraints: 0.768723 (s), 4350.62 (MB) / 4350.62 (MB) / 4362 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 309163 / 351456 / 1873
[Open3D DEBUG] Memory Usage: 4350.617 MB
[Open3D DEBUG] # Linear system solved: 12.2868 (s), 4350.62 (MB) / 4350.62 (MB) / 4362 (MB)
[Open3D DEBUG] Got average: 0.285903 (s), 4350.62 (MB) / 4350.62 (MB) / 4362 (MB)
[Open3D DEBUG] Iso-Value: 5.039396e-01 = 2.200704e+04 / 4.367000e+04
[Open3D DEBUG] #          Total Solve:      60.3 (s),    4365.8 (MB)
TriangleMesh with 45345 points and 90678 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0297, mean: -0.0346, std: 0.0021
Selected top reward seqs: tensor([-0.0316, -0.0315, -0.0315, -0.0314, -0.0313, -0.0312, -0.0312, -0.0311,
        -0.0311, -0.0309, -0.0309, -0.0309, -0.0309, -0.0308, -0.0308, -0.0305,
        -0.0305, -0.0303, -0.0303, -0.0297])
Batch 0/20:
reward seqs after 6 iterations: tensor([-0.0309], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 11 iterations: tensor([-0.0312], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 23 iterations: tensor([-0.0304], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 11 iterations: tensor([-0.0317], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 9 iterations: tensor([-0.0301], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 17 iterations: tensor([-0.0310], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 28 iterations: tensor([-0.0306], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 11 iterations: tensor([-0.0309], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 10 iterations: tensor([-0.0308], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 13 iterations: tensor([-0.0307], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 8 iterations: tensor([-0.0304], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 24 iterations: tensor([-0.0306], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 15 iterations: tensor([-0.0309], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 2 iterations: tensor([-0.0300], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 11 iterations: tensor([-0.0303], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 11 iterations: tensor([-0.0303], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 8 iterations: tensor([-0.0301], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 9 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 6 iterations: tensor([-0.0294], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 7 iterations: tensor([-0.0294], grad_fn=<CatBackward>)
Loss: 0.02935802936553955
Optimal set of params:
mid_point: tensor([[0.5191, 0.1400, 0.5327],
        [0.4722, 0.1400, 0.5029]])
angle: tensor([1.7581, 0.2760], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0099], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.5936, 0.1400, 0.9257, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.0874, 0.1400, 0.6120, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 44584 / 37042
[Open3D DEBUG] #   Got kernel density: 0.252769 (s), 5646.12 (MB) / 5646.12 (MB) / 5677 (MB)
[Open3D DEBUG] #     Got normal field: 0.383037 (s), 5651.65 (MB) / 5651.65 (MB) / 5677 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.474092e-05 / 1.994729e+00
[Open3D DEBUG] #       Finalized tree: 1.60724 (s), 5653.24 (MB) / 5653.24 (MB) / 5677 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.06751 (s), 5653.24 (MB) / 5653.24 (MB) / 5677 (MB)
[Open3D DEBUG] #Set point constraints: 1.05979 (s), 5653.24 (MB) / 5653.24 (MB) / 5677 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 472571 / 466120 / 73961
[Open3D DEBUG] Memory Usage: 5653.242 MB
[Open3D DEBUG] # Linear system solved: 10.7957 (s), 5653.75 (MB) / 5653.75 (MB) / 5677 (MB)
[Open3D DEBUG] Got average: 0.427381 (s), 5653.75 (MB) / 5653.75 (MB) / 5677 (MB)
[Open3D DEBUG] Iso-Value: 5.043116e-01 = 2.248423e+04 / 4.458400e+04
[Open3D DEBUG] #          Total Solve:      62.6 (s),    5660.3 (MB)
TriangleMesh with 69879 points and 139728 triangles.
EMD: tensor([0.0337], dtype=torch.float64)
Chamfer: tensor([0.0414], dtype=torch.float64)
=============== Iteration 0 -> model_loss: tensor([0.0294]); sim_loss: tensor([0.0344], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 43548 / 37575
[Open3D DEBUG] #   Got kernel density: 0.399997 (s), 5650.54 (MB) / 5660.34 (MB) / 5683 (MB)
[Open3D DEBUG] #     Got normal field: 0.290117 (s), 5651.86 (MB) / 5660.34 (MB) / 5683 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.604345e-05 / 2.440580e+00
[Open3D DEBUG] #       Finalized tree: 1.40028 (s), 5652.17 (MB) / 5660.34 (MB) / 5683 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.06471 (s), 5652.17 (MB) / 5660.34 (MB) / 5683 (MB)
[Open3D DEBUG] #Set point constraints: 1.11983 (s), 5652.17 (MB) / 5660.34 (MB) / 5683 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 478745 / 435976 / 111161
[Open3D DEBUG] Memory Usage: 5652.172 MB
[Open3D DEBUG] # Linear system solved: 13.7375 (s), 5652.2 (MB) / 5660.34 (MB) / 5683 (MB)
[Open3D DEBUG] Got average: 0.313346 (s), 5652.2 (MB) / 5660.34 (MB) / 5683 (MB)
[Open3D DEBUG] Iso-Value: 5.025048e-01 = 2.188308e+04 / 4.354800e+04
[Open3D DEBUG] #          Total Solve:      70.4 (s),    5664.7 (MB)
TriangleMesh with 65716 points and 131342 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0296, mean: -0.0345, std: 0.0022
Selected top reward seqs: tensor([-0.0314, -0.0312, -0.0310, -0.0310, -0.0309, -0.0309, -0.0308, -0.0308,
        -0.0307, -0.0307, -0.0307, -0.0307, -0.0307, -0.0305, -0.0301, -0.0300,
        -0.0298, -0.0297, -0.0297, -0.0296])
Batch 0/20:
reward seqs after 11 iterations: tensor([-0.0309], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 10 iterations: tensor([-0.0312], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 11 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 15 iterations: tensor([-0.0285], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 12 iterations: tensor([-0.0301], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 10 iterations: tensor([-0.0306], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 10 iterations: tensor([-0.0301], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 8 iterations: tensor([-0.0308], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 6 iterations: tensor([-0.0306], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 11 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 7 iterations: tensor([-0.0304], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 12 iterations: tensor([-0.0304], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 8 iterations: tensor([-0.0283], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 11 iterations: tensor([-0.0301], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 23 iterations: tensor([-0.0294], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 12 iterations: tensor([-0.0294], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 9 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 14 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 6 iterations: tensor([-0.0293], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 26 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Loss: 0.028345627710223198
Optimal set of params:
mid_point: tensor([[0.5221, 0.1400, 0.5202],
        [0.5357, 0.1400, 0.5574]])
angle: tensor([1.7265, 0.9518], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0113], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.5842, 0.1400, 0.9154, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.3036, 0.1400, 0.8831, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 44135 / 39985
[Open3D DEBUG] #   Got kernel density: 0.225067 (s), 5735.77 (MB) / 5735.77 (MB) / 5768 (MB)
[Open3D DEBUG] #     Got normal field: 0.180555 (s), 5739.4 (MB) / 5739.4 (MB) / 5768 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 7.298502e-05 / 3.221194e+00
[Open3D DEBUG] #       Finalized tree: 1.35745 (s), 5739.47 (MB) / 5739.47 (MB) / 5768 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.09809 (s), 5739.47 (MB) / 5739.47 (MB) / 5768 (MB)
[Open3D DEBUG] #Set point constraints: 1.18191 (s), 5739.47 (MB) / 5739.47 (MB) / 5768 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 576836 / 524568 / 134673
[Open3D DEBUG] Memory Usage: 5739.469 MB
[Open3D DEBUG] # Linear system solved: 13.6946 (s), 5739.47 (MB) / 5739.47 (MB) / 5768 (MB)
[Open3D DEBUG] Got average: 0.398789 (s), 5739.47 (MB) / 5739.47 (MB) / 5768 (MB)
[Open3D DEBUG] Iso-Value: 5.010545e-01 = 2.211404e+04 / 4.413500e+04
[Open3D DEBUG] #          Total Solve:      73.8 (s),    5747.8 (MB)
TriangleMesh with 85197 points and 170110 triangles.
EMD: tensor([0.0339], dtype=torch.float64)
Chamfer: tensor([0.0408], dtype=torch.float64)
=============== Iteration 1 -> model_loss: tensor([0.0283]); sim_loss: tensor([0.0346], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 45014 / 38893
[Open3D DEBUG] #   Got kernel density: 0.26619 (s), 5741.62 (MB) / 5747.82 (MB) / 5809 (MB)
[Open3D DEBUG] #     Got normal field: 0.315060 (s), 5742.71 (MB) / 5747.82 (MB) / 5809 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.524510e-05 / 2.486803e+00
[Open3D DEBUG] #       Finalized tree: 1.50739 (s), 5742.71 (MB) / 5747.82 (MB) / 5809 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.89662 (s), 5742.71 (MB) / 5747.82 (MB) / 5809 (MB)
[Open3D DEBUG] #Set point constraints: 0.986585 (s), 5742.71 (MB) / 5747.82 (MB) / 5809 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 500004 / 460136 / 111297
[Open3D DEBUG] Memory Usage: 5742.715 MB
[Open3D DEBUG] # Linear system solved: 11.1438 (s), 5742.89 (MB) / 5747.82 (MB) / 5809 (MB)
[Open3D DEBUG] Got average: 0.416846 (s), 5742.89 (MB) / 5747.82 (MB) / 5809 (MB)
[Open3D DEBUG] Iso-Value: 5.015299e-01 = 2.257587e+04 / 4.501400e+04
[Open3D DEBUG] #          Total Solve:      68.0 (s),    5753.9 (MB)
TriangleMesh with 70345 points and 140616 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0298, mean: -0.0354, std: 0.0027
Selected top reward seqs: tensor([-0.0316, -0.0316, -0.0316, -0.0316, -0.0314, -0.0313, -0.0313, -0.0311,
        -0.0311, -0.0310, -0.0309, -0.0308, -0.0307, -0.0306, -0.0305, -0.0304,
        -0.0304, -0.0301, -0.0299, -0.0298])
Batch 0/20:
reward seqs after 12 iterations: tensor([-0.0308], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 23 iterations: tensor([-0.0312], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 8 iterations: tensor([-0.0317], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 12 iterations: tensor([-0.0309], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 23 iterations: tensor([-0.0299], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 11 iterations: tensor([-0.0304], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 14 iterations: tensor([-0.0308], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 13 iterations: tensor([-0.0317], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 10 iterations: tensor([-0.0307], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 7 iterations: tensor([-0.0315], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 7 iterations: tensor([-0.0309], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 8 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 10 iterations: tensor([-0.0300], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 11 iterations: tensor([-0.0303], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 6 iterations: tensor([-0.0305], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 9 iterations: tensor([-0.0299], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 4 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 16 iterations: tensor([-0.0295], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 11 iterations: tensor([-0.0289], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 10 iterations: tensor([-0.0294], grad_fn=<CatBackward>)
Loss: 0.0289279967546463
Optimal set of params:
mid_point: tensor([[0.4217, 0.1400, 0.5653],
        [0.5404, 0.1400, 0.5687]])
angle: tensor([2.3472, 0.8793], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0113], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.7020, 0.1400, 0.8506, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.2853, 0.1400, 0.8768, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 45496 / 40705
[Open3D DEBUG] #   Got kernel density: 0.266050 (s), 5797.25 (MB) / 5797.25 (MB) / 5838 (MB)
[Open3D DEBUG] #     Got normal field: 0.240034 (s), 5800.89 (MB) / 5800.89 (MB) / 5838 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.620833e-05 / 3.012214e+00
[Open3D DEBUG] #       Finalized tree: 1.78575 (s), 5801.03 (MB) / 5801.03 (MB) / 5838 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.04885 (s), 5801.03 (MB) / 5801.03 (MB) / 5838 (MB)
[Open3D DEBUG] #Set point constraints: 1.06965 (s), 5801.03 (MB) / 5801.03 (MB) / 5838 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 559728 / 503760 / 135929
[Open3D DEBUG] Memory Usage: 5801.027 MB
[Open3D DEBUG] # Linear system solved: 12.2767 (s), 5801.03 (MB) / 5801.03 (MB) / 5838 (MB)
[Open3D DEBUG] Got average: 0.353003 (s), 5801.03 (MB) / 5801.03 (MB) / 5838 (MB)
[Open3D DEBUG] Iso-Value: 5.011735e-01 = 2.280139e+04 / 4.549600e+04
[Open3D DEBUG] #          Total Solve:      70.8 (s),    5809.8 (MB)
TriangleMesh with 80292 points and 160478 triangles.
EMD: tensor([0.0317], dtype=torch.float64)
Chamfer: tensor([0.0377], dtype=torch.float64)
=============== Iteration 2 -> model_loss: tensor([0.0289]); sim_loss: tensor([0.0323], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 45465 / 39768
[Open3D DEBUG] #   Got kernel density: 0.28659 (s), 5801.96 (MB) / 5809.76 (MB) / 5968 (MB)
[Open3D DEBUG] #     Got normal field: 0.249276 (s), 5803.04 (MB) / 5809.76 (MB) / 5968 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.829361e-05 / 2.650319e+00
[Open3D DEBUG] #       Finalized tree: 1.74657 (s), 5803.18 (MB) / 5809.76 (MB) / 5968 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.08197 (s), 5803.18 (MB) / 5809.76 (MB) / 5968 (MB)
[Open3D DEBUG] #Set point constraints: 1.04118 (s), 5803.18 (MB) / 5809.76 (MB) / 5968 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 525477 / 481856 / 118689
[Open3D DEBUG] Memory Usage: 5803.180 MB
[Open3D DEBUG] # Linear system solved: 11.38 (s), 5803.18 (MB) / 5809.76 (MB) / 5968 (MB)
[Open3D DEBUG] Got average: 0.329823 (s), 5803.18 (MB) / 5809.76 (MB) / 5968 (MB)
[Open3D DEBUG] Iso-Value: 5.009207e-01 = 2.277436e+04 / 4.546500e+04
[Open3D DEBUG] #          Total Solve:      66.5 (s),    5809.9 (MB)
TriangleMesh with 74622 points and 149172 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0295, mean: -0.0350, std: 0.0024
Selected top reward seqs: tensor([-0.0314, -0.0314, -0.0314, -0.0313, -0.0313, -0.0311, -0.0311, -0.0310,
        -0.0310, -0.0308, -0.0305, -0.0302, -0.0302, -0.0302, -0.0302, -0.0301,
        -0.0299, -0.0299, -0.0296, -0.0295])
Batch 0/20:
reward seqs after 12 iterations: tensor([-0.0307], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 10 iterations: tensor([-0.0307], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 19 iterations: tensor([-0.0305], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 15 iterations: tensor([-0.0295], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 12 iterations: tensor([-0.0310], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 8 iterations: tensor([-0.0316], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 7 iterations: tensor([-0.0313], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 30 iterations: tensor([-0.0314], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 8 iterations: tensor([-0.0306], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 21 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 11 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 14 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 16 iterations: tensor([-0.0293], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 22 iterations: tensor([-0.0292], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 11 iterations: tensor([-0.0294], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 12 iterations: tensor([-0.0300], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 10 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 10 iterations: tensor([-0.0300], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 12 iterations: tensor([-0.0294], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 9 iterations: tensor([-0.0287], grad_fn=<CatBackward>)
Loss: 0.028687400743365288
Optimal set of params:
mid_point: tensor([[0.4250, 0.1400, 0.5296],
        [0.4956, 0.1400, 0.5679]])
angle: tensor([0.0804, 0.7849], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0082, 0.0106], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.0263, 0.1400, 0.5617, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.2126, 0.1400, 0.8506, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
=============== 2/2 ===============
[Open3D DEBUG] Input Points / Samples: 46093 / 35889
[Open3D DEBUG] #   Got kernel density: 0.242725 (s), 5907.68 (MB) / 5907.68 (MB) / 5968 (MB)
[Open3D DEBUG] #     Got normal field: 0.125037 (s), 5909.86 (MB) / 5909.86 (MB) / 5968 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 3.284315e-05 / 1.513839e+00
[Open3D DEBUG] #       Finalized tree: 1.34659 (s), 5910.12 (MB) / 5910.12 (MB) / 5968 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.1462 (s), 5910.12 (MB) / 5910.12 (MB) / 5968 (MB)
[Open3D DEBUG] #Set point constraints: 0.837079 (s), 5910.12 (MB) / 5910.12 (MB) / 5968 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 455393 / 503312 / 17137
[Open3D DEBUG] Memory Usage: 5910.121 MB
[Open3D DEBUG] # Linear system solved: 10.6653 (s), 5910.12 (MB) / 5910.12 (MB) / 5968 (MB)
[Open3D DEBUG] Got average: 0.294901 (s), 5910.12 (MB) / 5910.12 (MB) / 5968 (MB)
[Open3D DEBUG] Iso-Value: 5.040752e-01 = 2.323434e+04 / 4.609300e+04
[Open3D DEBUG] #          Total Solve:      56.7 (s),    5913.3 (MB)
TriangleMesh with 75379 points and 150774 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0284, mean: -0.0329, std: 0.0023
Selected top reward seqs: tensor([-0.0300, -0.0300, -0.0299, -0.0299, -0.0299, -0.0298, -0.0297, -0.0297,
        -0.0296, -0.0296, -0.0295, -0.0294, -0.0294, -0.0292, -0.0291, -0.0289,
        -0.0288, -0.0287, -0.0285, -0.0284])
Batch 0/20:
reward seqs after 13 iterations: tensor([-0.0287], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 11 iterations: tensor([-0.0299], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 13 iterations: tensor([-0.0300], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 7 iterations: tensor([-0.0297], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 14 iterations: tensor([-0.0299], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 13 iterations: tensor([-0.0287], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 24 iterations: tensor([-0.0293], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 6 iterations: tensor([-0.0293], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 8 iterations: tensor([-0.0295], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 8 iterations: tensor([-0.0298], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 8 iterations: tensor([-0.0292], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 17 iterations: tensor([-0.0293], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 11 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 7 iterations: tensor([-0.0287], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 6 iterations: tensor([-0.0291], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 12 iterations: tensor([-0.0287], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 8 iterations: tensor([-0.0285], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 8 iterations: tensor([-0.0283], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 11 iterations: tensor([-0.0285], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 5 iterations: tensor([-0.0282], grad_fn=<CatBackward>)
Loss: 0.028178444132208824
Optimal set of params:
mid_point: tensor([[0.4381, 0.1400, 0.4577]])
angle: tensor([0.7757], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.1525, 0.1400, 0.7378, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 45686 / 41046
[Open3D DEBUG] #   Got kernel density: 0.473167 (s), 5926.39 (MB) / 5926.39 (MB) / 5968 (MB)
[Open3D DEBUG] #     Got normal field: 0.619014 (s), 5927.45 (MB) / 5927.45 (MB) / 5968 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 7.031345e-05 / 3.212340e+00
[Open3D DEBUG] #       Finalized tree: 1.68927 (s), 5927.56 (MB) / 5927.56 (MB) / 5968 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.18103 (s), 5927.56 (MB) / 5927.56 (MB) / 5968 (MB)
[Open3D DEBUG] #Set point constraints: 1.08847 (s), 5927.56 (MB) / 5927.56 (MB) / 5968 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 575513 / 515000 / 142729
[Open3D DEBUG] Memory Usage: 5927.562 MB
[Open3D DEBUG] # Linear system solved: 13.9857 (s), 5927.56 (MB) / 5927.56 (MB) / 5968 (MB)
[Open3D DEBUG] Got average: 0.343587 (s), 5927.56 (MB) / 5927.56 (MB) / 5968 (MB)
[Open3D DEBUG] Iso-Value: 5.004166e-01 = 2.286203e+04 / 4.568600e+04
[Open3D DEBUG] #          Total Solve:      72.4 (s),    5932.0 (MB)
TriangleMesh with 83416 points and 166692 triangles.
EMD: tensor([0.0300], dtype=torch.float64)
Chamfer: tensor([0.0384], dtype=torch.float64)
=============== Iteration 3 -> model_loss: tensor([0.0282]); sim_loss: tensor([0.0309], dtype=torch.float64) ===============
torch.Size([5, 11, 14]) torch.Size([5, 40, 12])
Best init pose: tensor([[0.5936, 0.1400, 0.9257, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.5842, 0.1400, 0.9154, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.7020, 0.1400, 0.8506, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.0263, 0.1400, 0.5617, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.1525, 0.1400, 0.7378, 1.0000, 0.0000, 0.0000, 0.0000]])
Best model loss: tensor([0.0282]); Best sim loss: tensor([0.0309], dtype=torch.float64)
Wrote profile results to control.py.lprof
