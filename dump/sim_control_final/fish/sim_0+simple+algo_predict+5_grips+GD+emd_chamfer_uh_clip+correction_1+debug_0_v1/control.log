ENV:
  loss:
    soft_contact: False
    target_path: envs/assets/Chopsticks3D-v1.npy
    weight:
      contact: 1
      density: 10
      sdf: 10
  n_observed_particles: 200
PRIMITIVES: [{'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.35, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.2, 'r': 0.045, 'init_pos': '(0.65, 0.4, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.8, 0.8, 0.8)', 'friction': 1.0, 'action': {'dim': 6, 'scale': '(0.02, 0.02, 0.02, 0.04, 0.04, 0.04)'}}, {'shape': 'Capsule', 'h': 0.13, 'r': 0.025, 'init_pos': '(0.5, 0.1, 0.5)', 'init_rot': '(1., 0., 0., 0.)', 'color': '(0.2, 0.2, 0.2)', 'friction': 15.0}]
RENDERER:
  bake_size: 6
  camera_pos: (0.5, 1.2, 4.0)
  camera_pos_1: (0.5, 2.5, 2.2)
  camera_pos_2: (0.5, 2.5, 2.2)
  camera_pos_3: (0.5, 2.5, 2.2)
  camera_pos_4: (0.5, 2.5, 2.2)
  camera_rot: (0.2, 0)
  camera_rot_1: (0.8, 0.0)
  camera_rot_2: (0.8, 0.0)
  camera_rot_3: (0.8, 0.0)
  camera_rot_4: (0.8, 0.0)
  dx: 0.006666666666666667
  image_res: (512, 512)
  light_direction: (2.0, 1.0, 0.7)
  max_num_particles: 1000000
  max_ray_depth: 2
  sdf_threshold: 0.20720000000000002
  spp: 50
  target_res: (64, 64, 64)
  use_directional_light: False
  use_roulette: False
  voxel_res: (168, 168, 168)
SHAPES: [{'shape': 'box', 'width': '(0.25, 0.2, 0.25)', 'init_pos': '(0.5, 0.1, 0.5)', 'n_particles': 20000, 'color': '((150<<8)+ (150<<16))'}]
SIMULATOR:
  E: 5000.0
  dim: 3
  dtype: float64
  gravity: (0, -5, 0)
  ground_friction: 100.0
  max_steps: 1024
  n_particles: 9000
  nu: 0.2
  quality: 1
  yield_stress: 4000.0
VARIANTS: [{'ENV': {'loss': {'target_path': 'envs/assets/gripper-v1.npy'}}}]
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.35, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 6
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04)
color: (0.8, 0.8, 0.8)
friction: 1.0
h: 0.2
init_pos: (0.65, 0.4, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.045
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
Building primitive
action:
  dim: 0
  scale: ()
color: (0.2, 0.2, 0.2)
friction: 15.0
h: 0.13
init_pos: (0.5, 0.1, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
r: 0.025
shape: Capsule
upper_bound: (1.0, 1.0, 1.0)
variations: None
{'width': (0.25, 0.2, 0.25), 'init_pos': (0.5, 0.1, 0.5), 'n_particles': 20000, 'color': 9868800}
Initialize Renderer
bake_size: 6  
camera_pos: (0.5, 1.2, 4.0)  
camera_pos_1: (0.5, 2.5, 2.2)  
camera_pos_2: (0.5, 2.5, 2.2)  
camera_pos_3: (0.5, 2.5, 2.2)  
camera_pos_4: (0.5, 2.5, 2.2)  
camera_rot: (0.2, 0)  
camera_rot_1: (0.8, 0.0)  
camera_rot_2: (0.8, 0.0)  
camera_rot_3: (0.8, 0.0)  
camera_rot_4: (0.8, 0.0)  
dx: 0.006666666666666667  
image_res: (512, 512)  
light_direction: (2.0, 1.0, 0.7)  
max_num_particles: 1000000  
max_ray_depth: 2  
sdf_threshold: 0.20720000000000002  
spp: 50  
target_res: (64, 64, 64)  
use_directional_light: False  
use_roulette: False  
voxel_res: (168, 168, 168)
[Taichi] materializing...
model_kp #params: 443560
GT shape: init pose: (1, 3, 11, 14); actions: (1, 3, 40, 12)
GT init pose: [[0.49119963 0.14       0.92617013 1.         0.         0.
  0.        ]
 [0.90975371 0.14       0.62744569 1.         0.         0.
  0.        ]
 [0.66744627 0.14       0.8448659  1.         0.         0.
  0.        ]]
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 43670 / 28229
[Open3D DEBUG] #   Got kernel density: 0.213538 (s), 4323.5 (MB) / 4323.5 (MB) / 4345 (MB)
[Open3D DEBUG] #     Got normal field: 0.122792 (s), 4330.4 (MB) / 4330.4 (MB) / 4345 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 2.048146e-05 / 8.944252e-01
[Open3D DEBUG] #       Finalized tree: 0.994426 (s), 4331.9 (MB) / 4331.9 (MB) / 4345 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.72208 (s), 4331.9 (MB) / 4331.9 (MB) / 4345 (MB)
[Open3D DEBUG] #Set point constraints: 0.580372 (s), 4331.9 (MB) / 4331.9 (MB) / 4345 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 309163 / 351456 / 1873
[Open3D DEBUG] Memory Usage: 4331.898 MB
[Open3D DEBUG] # Linear system solved: 8.00436 (s), 4331.9 (MB) / 4331.9 (MB) / 4345 (MB)
[Open3D DEBUG] Got average: 0.197283 (s), 4331.9 (MB) / 4331.9 (MB) / 4345 (MB)
[Open3D DEBUG] Iso-Value: 5.039395e-01 = 2.200704e+04 / 4.367000e+04
[Open3D DEBUG] #          Total Solve:      52.0 (s),    4347.8 (MB)
TriangleMesh with 45345 points and 90678 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0378, mean: -0.0440, std: 0.0030
Selected top reward seqs: tensor([-0.0400, -0.0400, -0.0399, -0.0399, -0.0398, -0.0396, -0.0394, -0.0394,
        -0.0393, -0.0392, -0.0389, -0.0388, -0.0387, -0.0386, -0.0386, -0.0384,
        -0.0382, -0.0382, -0.0378, -0.0378])
Batch 0/20:
reward seqs after 24 iterations: tensor([-0.0400], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 10 iterations: tensor([-0.0392], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 12 iterations: tensor([-0.0411], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 11 iterations: tensor([-0.0402], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 9 iterations: tensor([-0.0399], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 2 iterations: tensor([-0.0419], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 8 iterations: tensor([-0.0386], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 15 iterations: tensor([-0.0400], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 11 iterations: tensor([-0.0395], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 11 iterations: tensor([-0.0394], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 10 iterations: tensor([-0.0393], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 12 iterations: tensor([-0.0386], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 13 iterations: tensor([-0.0391], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 12 iterations: tensor([-0.0380], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 15 iterations: tensor([-0.0387], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 9 iterations: tensor([-0.0381], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 8 iterations: tensor([-0.0372], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 14 iterations: tensor([-0.0393], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 3 iterations: tensor([-0.0385], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 8 iterations: tensor([-0.0380], grad_fn=<CatBackward>)
Loss: 0.03723479062318802
Optimal set of params:
mid_point: tensor([[0.4960, 0.1400, 0.5407],
        [0.5588, 0.1400, 0.5420]])
angle: tensor([2.0769, 1.7438], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0113], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.6899, 0.1400, 0.8906, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.6276, 0.1400, 0.9360, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 44701 / 39345
[Open3D DEBUG] #   Got kernel density: 0.399365 (s), 5652.9 (MB) / 5652.9 (MB) / 5685 (MB)
[Open3D DEBUG] #     Got normal field: 0.273306 (s), 5659.17 (MB) / 5659.17 (MB) / 5685 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.816200e-05 / 2.599900e+00
[Open3D DEBUG] #       Finalized tree: 1.49391 (s), 5660.1 (MB) / 5660.1 (MB) / 5685 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.87471 (s), 5660.1 (MB) / 5660.1 (MB) / 5685 (MB)
[Open3D DEBUG] #Set point constraints: 1.07493 (s), 5660.1 (MB) / 5660.1 (MB) / 5685 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 517420 / 473856 / 117481
[Open3D DEBUG] Memory Usage: 5660.102 MB
[Open3D DEBUG] # Linear system solved: 10.3911 (s), 5660.22 (MB) / 5660.22 (MB) / 5685 (MB)
[Open3D DEBUG] Got average: 0.336556 (s), 5660.22 (MB) / 5660.22 (MB) / 5685 (MB)
[Open3D DEBUG] Iso-Value: 5.028474e-01 = 2.247778e+04 / 4.470100e+04
[Open3D DEBUG] #          Total Solve:      63.6 (s),    5667.4 (MB)
TriangleMesh with 73945 points and 147820 triangles.
EMD: tensor([0.0417], dtype=torch.float64)
Chamfer: tensor([0.0410], dtype=torch.float64)
=============== Iteration 0 -> model_loss: tensor([0.0372]); sim_loss: tensor([0.0416], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 42828 / 38005
[Open3D DEBUG] #   Got kernel density: 0.296099 (s), 5670.57 (MB) / 5670.57 (MB) / 5703 (MB)
[Open3D DEBUG] #     Got normal field: 0.142998 (s), 5674.96 (MB) / 5674.96 (MB) / 5703 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.839294e-05 / 2.929133e+00
[Open3D DEBUG] #       Finalized tree: 1.14619 (s), 5675.02 (MB) / 5675.02 (MB) / 5703 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.91496 (s), 5675.02 (MB) / 5675.02 (MB) / 5703 (MB)
[Open3D DEBUG] #Set point constraints: 0.88553 (s), 5675.02 (MB) / 5675.02 (MB) / 5703 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 531693 / 481136 / 126513
[Open3D DEBUG] Memory Usage: 5675.016 MB
[Open3D DEBUG] # Linear system solved: 10.4030 (s), 5675.23 (MB) / 5675.23 (MB) / 5703 (MB)
[Open3D DEBUG] Got average: 0.260835 (s), 5675.23 (MB) / 5675.23 (MB) / 5703 (MB)
[Open3D DEBUG] Iso-Value: 5.009744e-01 = 2.145573e+04 / 4.282800e+04
[Open3D DEBUG] #          Total Solve:      62.5 (s),    5684.0 (MB)
TriangleMesh with 75270 points and 150366 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0371, mean: -0.0441, std: 0.0031
Selected top reward seqs: tensor([-0.0397, -0.0396, -0.0396, -0.0396, -0.0396, -0.0395, -0.0394, -0.0393,
        -0.0392, -0.0392, -0.0388, -0.0388, -0.0387, -0.0387, -0.0385, -0.0384,
        -0.0378, -0.0374, -0.0373, -0.0371])
Batch 0/20:
reward seqs after 9 iterations: tensor([-0.0387], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 7 iterations: tensor([-0.0391], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 9 iterations: tensor([-0.0404], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 16 iterations: tensor([-0.0382], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 27 iterations: tensor([-0.0394], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 14 iterations: tensor([-0.0394], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 19 iterations: tensor([-0.0399], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 15 iterations: tensor([-0.0398], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 10 iterations: tensor([-0.0400], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 23 iterations: tensor([-0.0394], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 8 iterations: tensor([-0.0393], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 9 iterations: tensor([-0.0388], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 8 iterations: tensor([-0.0386], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 11 iterations: tensor([-0.0386], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 8 iterations: tensor([-0.0386], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 9 iterations: tensor([-0.0384], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 8 iterations: tensor([-0.0378], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 8 iterations: tensor([-0.0375], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 18 iterations: tensor([-0.0379], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 14 iterations: tensor([-0.0372], grad_fn=<CatBackward>)
Loss: 0.03718578815460205
Optimal set of params:
mid_point: tensor([[0.5591, 0.1400, 0.4240],
        [0.5750, 0.1400, 0.5756]])
angle: tensor([1.4397, 1.9191], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0101, 0.0105], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.5068, 0.1400, 0.8206, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.7115, 0.1400, 0.9516, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 45108 / 39146
[Open3D DEBUG] #   Got kernel density: 0.375936 (s), 5738.77 (MB) / 5738.77 (MB) / 5779 (MB)
[Open3D DEBUG] #     Got normal field: 0.299835 (s), 5740.76 (MB) / 5740.76 (MB) / 5779 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.154888e-05 / 2.325267e+00
[Open3D DEBUG] #       Finalized tree: 1.23972 (s), 5740.8 (MB) / 5740.8 (MB) / 5779 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.93874 (s), 5740.8 (MB) / 5740.8 (MB) / 5779 (MB)
[Open3D DEBUG] #Set point constraints: 0.949094 (s), 5740.8 (MB) / 5740.8 (MB) / 5779 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 516195 / 501160 / 88777
[Open3D DEBUG] Memory Usage: 5740.801 MB
[Open3D DEBUG] # Linear system solved: 10.2829 (s), 5740.8 (MB) / 5740.8 (MB) / 5779 (MB)
[Open3D DEBUG] Got average: 0.2651 (s), 5740.8 (MB) / 5740.8 (MB) / 5779 (MB)
[Open3D DEBUG] Iso-Value: 5.020041e-01 = 2.264440e+04 / 4.510800e+04
[Open3D DEBUG] #          Total Solve:      63.0 (s),    5749.3 (MB)
TriangleMesh with 78177 points and 156310 triangles.
EMD: tensor([0.0497], dtype=torch.float64)
Chamfer: tensor([0.0418], dtype=torch.float64)
=============== Iteration 1 -> model_loss: tensor([0.0372]); sim_loss: tensor([0.0489], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 44887 / 37082
[Open3D DEBUG] #   Got kernel density: 0.195006 (s), 5744.93 (MB) / 5749.32 (MB) / 5810 (MB)
[Open3D DEBUG] #     Got normal field: 0.13519 (s), 5746.46 (MB) / 5749.32 (MB) / 5810 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 4.369208e-05 / 1.961206e+00
[Open3D DEBUG] #       Finalized tree: 1.28524 (s), 5746.75 (MB) / 5749.32 (MB) / 5810 (MB)
[Open3D DEBUG] #  Set FEM constraints: 2.01431 (s), 5746.75 (MB) / 5749.32 (MB) / 5810 (MB)
[Open3D DEBUG] #Set point constraints: 1.12307 (s), 5746.75 (MB) / 5749.32 (MB) / 5810 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 469589 / 467264 / 69409
[Open3D DEBUG] Memory Usage: 5746.754 MB
[Open3D DEBUG] # Linear system solved: 10.6859 (s), 5746.75 (MB) / 5749.32 (MB) / 5810 (MB)
[Open3D DEBUG] Got average: 0.265931 (s), 5746.75 (MB) / 5749.32 (MB) / 5810 (MB)
[Open3D DEBUG] Iso-Value: 5.039519e-01 = 2.262089e+04 / 4.488700e+04
[Open3D DEBUG] #          Total Solve:      61.2 (s),    5755.0 (MB)
TriangleMesh with 71695 points and 143378 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0352, mean: -0.0430, std: 0.0031
Selected top reward seqs: tensor([-0.0390, -0.0389, -0.0388, -0.0387, -0.0386, -0.0384, -0.0384, -0.0383,
        -0.0382, -0.0381, -0.0379, -0.0377, -0.0377, -0.0376, -0.0374, -0.0373,
        -0.0371, -0.0361, -0.0361, -0.0352])
Batch 0/20:
reward seqs after 11 iterations: tensor([-0.0383], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 9 iterations: tensor([-0.0393], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 3 iterations: tensor([-0.0362], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 17 iterations: tensor([-0.0369], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 15 iterations: tensor([-0.0386], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 8 iterations: tensor([-0.0379], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 9 iterations: tensor([-0.0380], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 21 iterations: tensor([-0.0363], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 9 iterations: tensor([-0.0374], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 9 iterations: tensor([-0.0373], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 6 iterations: tensor([-0.0373], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 5 iterations: tensor([-0.0369], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 21 iterations: tensor([-0.0370], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 12 iterations: tensor([-0.0352], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 11 iterations: tensor([-0.0362], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 9 iterations: tensor([-0.0371], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 11 iterations: tensor([-0.0365], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 17 iterations: tensor([-0.0357], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 23 iterations: tensor([-0.0357], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 11 iterations: tensor([-0.0346], grad_fn=<CatBackward>)
Loss: 0.03462085872888565
Optimal set of params:
mid_point: tensor([[0.5141, 0.1400, 0.5226],
        [0.5690, 0.1400, 0.5683]])
angle: tensor([1.9778, 1.8161], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0110, 0.0105], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.6724, 0.1400, 0.8899, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.6661, 0.1400, 0.9563, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 45756 / 39885
[Open3D DEBUG] #   Got kernel density: 0.225955 (s), 5798.31 (MB) / 5798.31 (MB) / 5839 (MB)
[Open3D DEBUG] #     Got normal field: 0.131484 (s), 5798.84 (MB) / 5798.84 (MB) / 5839 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.061884e-05 / 2.316116e+00
[Open3D DEBUG] #       Finalized tree: 1.31138 (s), 5798.91 (MB) / 5798.91 (MB) / 5839 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.65278 (s), 5798.91 (MB) / 5798.91 (MB) / 5839 (MB)
[Open3D DEBUG] #Set point constraints: 1.0263 (s), 5798.91 (MB) / 5798.91 (MB) / 5839 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 519296 / 506256 / 87225
[Open3D DEBUG] Memory Usage: 5798.910 MB
[Open3D DEBUG] # Linear system solved: 9.74959 (s), 5798.91 (MB) / 5798.91 (MB) / 5839 (MB)
[Open3D DEBUG] Got average: 0.322503 (s), 5798.91 (MB) / 5798.91 (MB) / 5839 (MB)
[Open3D DEBUG] Iso-Value: 5.019537e-01 = 2.296739e+04 / 4.575600e+04
[Open3D DEBUG] #          Total Solve:      62.0 (s),    5807.9 (MB)
TriangleMesh with 79688 points and 159368 triangles.
EMD: tensor([0.0540], dtype=torch.float64)
Chamfer: tensor([0.0433], dtype=torch.float64)
=============== Iteration 2 -> model_loss: tensor([0.0346]); sim_loss: tensor([0.0529], dtype=torch.float64) ===============
=============== 1/2 ===============
[Open3D DEBUG] Input Points / Samples: 45742 / 40686
[Open3D DEBUG] #   Got kernel density: 0.254581 (s), 5800.63 (MB) / 5807.88 (MB) / 5961 (MB)
[Open3D DEBUG] #     Got normal field: 0.222121 (s), 5802.28 (MB) / 5807.88 (MB) / 5961 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.002448e-05 / 2.745640e+00
[Open3D DEBUG] #       Finalized tree: 1.29127 (s), 5802.32 (MB) / 5807.88 (MB) / 5961 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.99782 (s), 5802.32 (MB) / 5807.88 (MB) / 5961 (MB)
[Open3D DEBUG] #Set point constraints: 1.05702 (s), 5802.32 (MB) / 5807.88 (MB) / 5961 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 542585 / 496536 / 123561
[Open3D DEBUG] Memory Usage: 5802.316 MB
[Open3D DEBUG] # Linear system solved: 11.4905 (s), 5802.78 (MB) / 5807.88 (MB) / 5961 (MB)
[Open3D DEBUG] Got average: 0.349804 (s), 5802.95 (MB) / 5807.88 (MB) / 5961 (MB)
[Open3D DEBUG] Iso-Value: 5.020944e-01 = 2.296680e+04 / 4.574200e+04
[Open3D DEBUG] #          Total Solve:      64.3 (s),    5808.3 (MB)
TriangleMesh with 77397 points and 154686 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0322, mean: -0.0418, std: 0.0040
Selected top reward seqs: tensor([-0.0357, -0.0356, -0.0355, -0.0353, -0.0353, -0.0352, -0.0345, -0.0342,
        -0.0341, -0.0339, -0.0338, -0.0335, -0.0335, -0.0332, -0.0327, -0.0326,
        -0.0325, -0.0325, -0.0324, -0.0322])
Batch 0/20:
reward seqs after 16 iterations: tensor([-0.0354], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 16 iterations: tensor([-0.0349], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 25 iterations: tensor([-0.0360], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 7 iterations: tensor([-0.0362], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 11 iterations: tensor([-0.0365], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 27 iterations: tensor([-0.0350], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 9 iterations: tensor([-0.0335], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 9 iterations: tensor([-0.0335], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 31 iterations: tensor([-0.0334], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 12 iterations: tensor([-0.0338], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 12 iterations: tensor([-0.0328], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 11 iterations: tensor([-0.0334], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 6 iterations: tensor([-0.0317], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 27 iterations: tensor([-0.0329], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 10 iterations: tensor([-0.0319], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 14 iterations: tensor([-0.0322], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 18 iterations: tensor([-0.0317], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 13 iterations: tensor([-0.0327], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 11 iterations: tensor([-0.0314], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 17 iterations: tensor([-0.0315], grad_fn=<CatBackward>)
Loss: 0.03135449439287186
Optimal set of params:
mid_point: tensor([[0.4369, 0.1400, 0.5478],
        [0.5118, 0.1400, 0.5295]])
angle: tensor([0.9519, 1.9568], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113, 0.0110], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.2049, 0.1400, 0.8736, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.6624, 0.1400, 0.9001, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
=============== 2/2 ===============
[Open3D DEBUG] Input Points / Samples: 44566 / 40210
[Open3D DEBUG] #   Got kernel density: 0.236439 (s), 5907.14 (MB) / 5907.14 (MB) / 5961 (MB)
[Open3D DEBUG] #     Got normal field: 0.166418 (s), 5909.5 (MB) / 5909.5 (MB) / 5961 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 6.721665e-05 / 2.995577e+00
[Open3D DEBUG] #       Finalized tree: 1.28946 (s), 5909.7 (MB) / 5909.7 (MB) / 5961 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.94038 (s), 5909.7 (MB) / 5909.7 (MB) / 5961 (MB)
[Open3D DEBUG] #Set point constraints: 0.967709 (s), 5909.7 (MB) / 5909.7 (MB) / 5961 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 567589 / 520016 / 128657
[Open3D DEBUG] Memory Usage: 5909.703 MB
[Open3D DEBUG] # Linear system solved: 10.054 (s), 5909.7 (MB) / 5909.7 (MB) / 5961 (MB)
[Open3D DEBUG] Got average: 0.306283 (s), 5909.7 (MB) / 5909.7 (MB) / 5961 (MB)
[Open3D DEBUG] Iso-Value: 5.027488e-01 = 2.240550e+04 / 4.456600e+04
[Open3D DEBUG] #          Total Solve:      62.6 (s),    5922.2 (MB)
TriangleMesh with 83503 points and 166770 triangles.
state_cur: torch.Size([4, 300, 3]), state_goal: torch.Size([1, 300, 3])
sampling: max: -0.0293, mean: -0.0363, std: 0.0036
Selected top reward seqs: tensor([-0.0314, -0.0314, -0.0312, -0.0312, -0.0310, -0.0309, -0.0309, -0.0309,
        -0.0307, -0.0307, -0.0307, -0.0307, -0.0306, -0.0305, -0.0305, -0.0305,
        -0.0304, -0.0303, -0.0301, -0.0293])
Batch 0/20:
reward seqs after 5 iterations: tensor([-0.0315], grad_fn=<CatBackward>)
Batch 1/20:
reward seqs after 9 iterations: tensor([-0.0314], grad_fn=<CatBackward>)
Batch 2/20:
reward seqs after 32 iterations: tensor([-0.0308], grad_fn=<CatBackward>)
Batch 3/20:
reward seqs after 4 iterations: tensor([-0.0310], grad_fn=<CatBackward>)
Batch 4/20:
reward seqs after 23 iterations: tensor([-0.0307], grad_fn=<CatBackward>)
Batch 5/20:
reward seqs after 13 iterations: tensor([-0.0310], grad_fn=<CatBackward>)
Batch 6/20:
reward seqs after 8 iterations: tensor([-0.0307], grad_fn=<CatBackward>)
Batch 7/20:
reward seqs after 14 iterations: tensor([-0.0307], grad_fn=<CatBackward>)
Batch 8/20:
reward seqs after 7 iterations: tensor([-0.0306], grad_fn=<CatBackward>)
Batch 9/20:
reward seqs after 6 iterations: tensor([-0.0305], grad_fn=<CatBackward>)
Batch 10/20:
reward seqs after 5 iterations: tensor([-0.0306], grad_fn=<CatBackward>)
Batch 11/20:
reward seqs after 8 iterations: tensor([-0.0305], grad_fn=<CatBackward>)
Batch 12/20:
reward seqs after 16 iterations: tensor([-0.0298], grad_fn=<CatBackward>)
Batch 13/20:
reward seqs after 6 iterations: tensor([-0.0310], grad_fn=<CatBackward>)
Batch 14/20:
reward seqs after 14 iterations: tensor([-0.0305], grad_fn=<CatBackward>)
Batch 15/20:
reward seqs after 13 iterations: tensor([-0.0301], grad_fn=<CatBackward>)
Batch 16/20:
reward seqs after 9 iterations: tensor([-0.0304], grad_fn=<CatBackward>)
Batch 17/20:
reward seqs after 11 iterations: tensor([-0.0302], grad_fn=<CatBackward>)
Batch 18/20:
reward seqs after 7 iterations: tensor([-0.0296], grad_fn=<CatBackward>)
Batch 19/20:
reward seqs after 4 iterations: tensor([-0.0288], grad_fn=<CatBackward>)
Loss: 0.028798170387744904
Optimal set of params:
mid_point: tensor([[0.4145, 0.1400, 0.5448]])
angle: tensor([0.8713], grad_fn=<SelectBackward>)
gripper_rate: tensor([0.0113], grad_fn=<ClampBackward1>)
Optimal init pose seq: tensor([[0.1570, 0.1400, 0.8509, 1.0000, 0.0000, 0.0000, 0.0000]],
       grad_fn=<SliceBackward>)
[Open3D DEBUG] Input Points / Samples: 45986 / 40717
[Open3D DEBUG] #   Got kernel density: 0.227975 (s), 5940.32 (MB) / 5940.32 (MB) / 5973 (MB)
[Open3D DEBUG] #     Got normal field: 0.152533 (s), 5940.73 (MB) / 5940.73 (MB) / 5973 (MB)
[Open3D DEBUG] Point weight / Estimated Area: 5.842333e-05 / 2.686655e+00
[Open3D DEBUG] #       Finalized tree: 1.23787 (s), 5940.86 (MB) / 5940.86 (MB) / 5973 (MB)
[Open3D DEBUG] #  Set FEM constraints: 1.86223 (s), 5940.86 (MB) / 5940.86 (MB) / 5973 (MB)
[Open3D DEBUG] #Set point constraints: 1.24065 (s), 5940.86 (MB) / 5940.86 (MB) / 5973 (MB)
[Open3D DEBUG] Leaf Nodes / Active Nodes / Ghost Nodes: 544153 / 503984 / 117905
[Open3D DEBUG] Memory Usage: 5940.859 MB
[Open3D DEBUG] # Linear system solved: 9.40415 (s), 5940.88 (MB) / 5940.88 (MB) / 5973 (MB)
[Open3D DEBUG] Got average: 0.290502 (s), 5940.88 (MB) / 5940.88 (MB) / 5973 (MB)
[Open3D DEBUG] Iso-Value: 5.034108e-01 = 2.314985e+04 / 4.598600e+04
[Open3D DEBUG] #          Total Solve:      58.5 (s),    5947.2 (MB)
TriangleMesh with 81836 points and 163586 triangles.
EMD: tensor([0.0297], dtype=torch.float64)
Chamfer: tensor([0.0377], dtype=torch.float64)
=============== Iteration 3 -> model_loss: tensor([0.0288]); sim_loss: tensor([0.0305], dtype=torch.float64) ===============
torch.Size([5, 11, 14]) torch.Size([5, 40, 12])
Best init pose: tensor([[0.6899, 0.1400, 0.8906, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.5068, 0.1400, 0.8206, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.6724, 0.1400, 0.8899, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.2049, 0.1400, 0.8736, 1.0000, 0.0000, 0.0000, 0.0000],
        [0.1570, 0.1400, 0.8509, 1.0000, 0.0000, 0.0000, 0.0000]])
Best model loss: tensor([0.0288]); Best sim loss: tensor([0.0305], dtype=torch.float64)
Wrote profile results to control.py.lprof
